nohup: ignoring input
/home/gaobin/miniconda3/envs/vlm/lib/python3.11/site-packages/transformers/optimization.py:640: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
Using device: cuda
training starts
Epoch 1/5:   0%|          | 0/180 [00:00<?, ?it/s]Epoch 1/5:   0%|          | 0/180 [00:00<?, ?it/s, loss=0.726]Epoch 1/5:   0%|          | 0/180 [00:01<?, ?it/s, loss=0.726]Epoch 1/5:   0%|          | 0/180 [00:01<?, ?it/s, loss=0.704]Epoch 1/5:   0%|          | 0/180 [00:02<?, ?it/s, loss=0.688]Epoch 1/5:   0%|          | 0/180 [00:02<?, ?it/s, loss=0.678]Epoch 1/5:   0%|          | 0/180 [00:03<?, ?it/s, loss=0.65] Epoch 1/5:   0%|          | 0/180 [00:03<?, ?it/s, loss=0.695]Epoch 1/5:   0%|          | 0/180 [00:04<?, ?it/s, loss=0.703]Epoch 1/5:   0%|          | 0/180 [00:04<?, ?it/s, loss=0.629]Epoch 1/5:   0%|          | 0/180 [00:04<?, ?it/s, loss=0.677]Epoch 1/5:   0%|          | 0/180 [00:05<?, ?it/s, loss=0.68] Epoch 1/5:   0%|          | 0/180 [00:05<?, ?it/s, loss=0.654]Epoch 1/5:   0%|          | 0/180 [00:06<?, ?it/s, loss=0.729]Epoch 1/5:   0%|          | 0/180 [00:06<?, ?it/s, loss=0.679]Epoch 1/5:   0%|          | 0/180 [00:07<?, ?it/s, loss=0.627]Epoch 1/5:   0%|          | 0/180 [00:07<?, ?it/s, loss=0.635]Epoch 1/5:   0%|          | 0/180 [00:08<?, ?it/s, loss=0.671]Epoch 1/5:   0%|          | 0/180 [00:08<?, ?it/s, loss=0.669]Epoch 1/5:   0%|          | 0/180 [00:09<?, ?it/s, loss=0.74] Epoch 1/5:   0%|          | 0/180 [00:09<?, ?it/s, loss=0.577]Epoch 1/5:   0%|          | 0/180 [00:10<?, ?it/s, loss=0.651]Epoch 1/5:   0%|          | 0/180 [00:10<?, ?it/s, loss=0.768]Epoch 1/5:   0%|          | 0/180 [00:10<?, ?it/s, loss=0.687]Epoch 1/5:   0%|          | 0/180 [00:11<?, ?it/s, loss=0.708]Epoch 1/5:   0%|          | 0/180 [00:11<?, ?it/s, loss=0.639]Epoch 1/5:   0%|          | 0/180 [00:12<?, ?it/s, loss=0.644]Epoch 1/5:   0%|          | 0/180 [00:12<?, ?it/s, loss=0.614]Epoch 1/5:   0%|          | 0/180 [00:13<?, ?it/s, loss=0.677]Epoch 1/5:   0%|          | 0/180 [00:13<?, ?it/s, loss=0.707]Epoch 1/5:   0%|          | 0/180 [00:14<?, ?it/s, loss=0.549]Epoch 1/5:   0%|          | 0/180 [00:14<?, ?it/s, loss=0.677]Epoch 1/5:   0%|          | 0/180 [00:15<?, ?it/s, loss=0.532]Epoch 1/5:   0%|          | 0/180 [00:15<?, ?it/s, loss=0.483]Epoch 1/5:   0%|          | 0/180 [00:16<?, ?it/s, loss=0.721]Epoch 1/5:   0%|          | 0/180 [00:16<?, ?it/s, loss=0.586]Epoch 1/5:   0%|          | 0/180 [00:17<?, ?it/s, loss=0.587]Epoch 1/5:   0%|          | 0/180 [00:17<?, ?it/s, loss=0.529]Epoch 1/5:   0%|          | 0/180 [00:17<?, ?it/s, loss=0.649]Epoch 1/5:   0%|          | 0/180 [00:18<?, ?it/s, loss=0.527]Epoch 1/5:   0%|          | 0/180 [00:18<?, ?it/s, loss=0.644]Epoch 1/5:   0%|          | 0/180 [00:19<?, ?it/s, loss=0.637]Epoch 1/5:   0%|          | 0/180 [00:19<?, ?it/s, loss=0.611]Epoch 1/5:   0%|          | 0/180 [00:20<?, ?it/s, loss=0.596]Epoch 1/5:   0%|          | 0/180 [00:20<?, ?it/s, loss=0.763]Epoch 1/5:   0%|          | 0/180 [00:21<?, ?it/s, loss=0.684]Epoch 1/5:   0%|          | 0/180 [00:21<?, ?it/s, loss=0.671]Epoch 1/5:   0%|          | 0/180 [00:22<?, ?it/s, loss=0.492]Epoch 1/5:   0%|          | 0/180 [00:22<?, ?it/s, loss=0.65] Epoch 1/5:   0%|          | 0/180 [00:23<?, ?it/s, loss=0.683]Epoch 1/5:   0%|          | 0/180 [00:23<?, ?it/s, loss=0.593]Epoch 1/5:   0%|          | 0/180 [00:24<?, ?it/s, loss=0.837]Epoch 1/5:   0%|          | 0/180 [00:24<?, ?it/s, loss=0.671]Epoch 1/5:   0%|          | 0/180 [00:24<?, ?it/s, loss=0.853]Epoch 1/5:   0%|          | 0/180 [00:25<?, ?it/s, loss=0.816]Epoch 1/5:   0%|          | 0/180 [00:25<?, ?it/s, loss=0.756]Epoch 1/5:   0%|          | 0/180 [00:26<?, ?it/s, loss=0.772]Epoch 1/5:   0%|          | 0/180 [00:26<?, ?it/s, loss=0.498]Epoch 1/5:   0%|          | 0/180 [00:27<?, ?it/s, loss=0.509]Epoch 1/5:   0%|          | 0/180 [00:27<?, ?it/s, loss=0.729]Epoch 1/5:   0%|          | 0/180 [00:28<?, ?it/s, loss=0.43] Epoch 1/5:   0%|          | 0/180 [00:28<?, ?it/s, loss=0.567]Epoch 1/5:   0%|          | 0/180 [00:29<?, ?it/s, loss=0.65] Epoch 1/5:   0%|          | 0/180 [00:29<?, ?it/s, loss=0.688]Epoch 1/5:   0%|          | 0/180 [00:30<?, ?it/s, loss=1.01] Epoch 1/5:   0%|          | 0/180 [00:30<?, ?it/s, loss=0.421]Epoch 1/5:   0%|          | 0/180 [00:31<?, ?it/s, loss=0.509]Epoch 1/5:   0%|          | 0/180 [00:31<?, ?it/s, loss=0.738]Epoch 1/5:   0%|          | 0/180 [00:31<?, ?it/s, loss=0.521]Epoch 1/5:   0%|          | 0/180 [00:32<?, ?it/s, loss=0.657]Epoch 1/5:   0%|          | 0/180 [00:32<?, ?it/s, loss=0.669]Epoch 1/5:   0%|          | 0/180 [00:33<?, ?it/s, loss=0.507]Epoch 1/5:   0%|          | 0/180 [00:33<?, ?it/s, loss=0.68] Epoch 1/5:   0%|          | 0/180 [00:34<?, ?it/s, loss=0.589]Epoch 1/5:   0%|          | 0/180 [00:34<?, ?it/s, loss=0.671]Epoch 1/5:   0%|          | 0/180 [00:35<?, ?it/s, loss=0.667]Epoch 1/5:   0%|          | 0/180 [00:35<?, ?it/s, loss=0.583]Epoch 1/5:   0%|          | 0/180 [00:36<?, ?it/s, loss=0.496]Epoch 1/5:   0%|          | 0/180 [00:36<?, ?it/s, loss=0.643]Epoch 1/5:   0%|          | 0/180 [00:37<?, ?it/s, loss=0.48] Epoch 1/5:   0%|          | 0/180 [00:37<?, ?it/s, loss=0.571]Epoch 1/5:   0%|          | 0/180 [00:38<?, ?it/s, loss=0.597]Epoch 1/5:   0%|          | 0/180 [00:38<?, ?it/s, loss=0.697]Epoch 1/5:   0%|          | 0/180 [00:38<?, ?it/s, loss=0.585]Epoch 1/5:   0%|          | 0/180 [00:39<?, ?it/s, loss=0.754]Epoch 1/5:   0%|          | 0/180 [00:39<?, ?it/s, loss=0.862]Epoch 1/5:   0%|          | 0/180 [00:40<?, ?it/s, loss=0.749]Epoch 1/5:   0%|          | 0/180 [00:40<?, ?it/s, loss=0.577]Epoch 1/5:   0%|          | 0/180 [00:41<?, ?it/s, loss=0.588]Epoch 1/5:   0%|          | 0/180 [00:41<?, ?it/s, loss=0.509]Epoch 1/5:   0%|          | 0/180 [00:42<?, ?it/s, loss=0.679]Epoch 1/5:   0%|          | 0/180 [00:42<?, ?it/s, loss=0.586]Epoch 1/5:   0%|          | 0/180 [00:43<?, ?it/s, loss=0.678]Epoch 1/5:   0%|          | 0/180 [00:43<?, ?it/s, loss=0.437]Epoch 1/5:   0%|          | 0/180 [00:44<?, ?it/s, loss=0.478]Epoch 1/5:   0%|          | 0/180 [00:44<?, ?it/s, loss=0.654]Epoch 1/5:   0%|          | 0/180 [00:45<?, ?it/s, loss=0.439]Epoch 1/5:   0%|          | 0/180 [00:45<?, ?it/s, loss=0.569]Epoch 1/5:   0%|          | 0/180 [00:46<?, ?it/s, loss=0.851]Epoch 1/5:   0%|          | 0/180 [00:46<?, ?it/s, loss=0.67] Epoch 1/5:   0%|          | 0/180 [00:46<?, ?it/s, loss=0.677]Epoch 1/5:   0%|          | 0/180 [00:47<?, ?it/s, loss=0.483]Epoch 1/5:   0%|          | 0/180 [00:47<?, ?it/s, loss=0.687]Epoch 1/5:   0%|          | 0/180 [00:48<?, ?it/s, loss=0.565]Epoch 1/5:   0%|          | 0/180 [00:48<?, ?it/s, loss=0.578]Epoch 1/5:   0%|          | 0/180 [00:49<?, ?it/s, loss=0.854]Epoch 1/5:   0%|          | 0/180 [00:49<?, ?it/s, loss=0.578]Epoch 1/5:   0%|          | 0/180 [00:50<?, ?it/s, loss=0.601]Epoch 1/5:   0%|          | 0/180 [00:50<?, ?it/s, loss=0.892]Epoch 1/5:   0%|          | 0/180 [00:51<?, ?it/s, loss=0.656]Epoch 1/5:   0%|          | 0/180 [00:51<?, ?it/s, loss=0.69] Epoch 1/5:   0%|          | 0/180 [00:52<?, ?it/s, loss=0.489]Epoch 1/5:   0%|          | 0/180 [00:52<?, ?it/s, loss=0.585]Epoch 1/5:   0%|          | 0/180 [00:53<?, ?it/s, loss=0.834]Epoch 1/5:   0%|          | 0/180 [00:53<?, ?it/s, loss=0.637]Epoch 1/5:   0%|          | 0/180 [00:54<?, ?it/s, loss=0.573]Epoch 1/5:   0%|          | 0/180 [00:54<?, ?it/s, loss=0.937]Epoch 1/5:   0%|          | 0/180 [00:55<?, ?it/s, loss=0.656]Epoch 1/5:   0%|          | 0/180 [00:55<?, ?it/s, loss=0.737]Epoch 1/5:   0%|          | 0/180 [00:56<?, ?it/s, loss=0.489]Epoch 1/5:   0%|          | 0/180 [00:56<?, ?it/s, loss=0.656]Epoch 1/5:   0%|          | 0/180 [00:57<?, ?it/s, loss=0.596]Epoch 1/5:   0%|          | 0/180 [00:57<?, ?it/s, loss=0.573]Epoch 1/5:   0%|          | 0/180 [00:58<?, ?it/s, loss=0.843]Epoch 1/5:   0%|          | 0/180 [00:58<?, ?it/s, loss=0.588]Epoch 1/5:   0%|          | 0/180 [00:58<?, ?it/s, loss=0.595]Epoch 1/5:   0%|          | 0/180 [00:59<?, ?it/s, loss=0.729]Epoch 1/5:   0%|          | 0/180 [00:59<?, ?it/s, loss=0.489]Epoch 1/5:   0%|          | 0/180 [01:00<?, ?it/s, loss=0.532]Epoch 1/5:   0%|          | 0/180 [01:00<?, ?it/s, loss=0.485]Epoch 1/5:   0%|          | 0/180 [01:01<?, ?it/s, loss=0.755]Epoch 1/5:   0%|          | 0/180 [01:01<?, ?it/s, loss=0.437]Epoch 1/5:   0%|          | 0/180 [01:02<?, ?it/s, loss=0.509]Epoch 1/5:   0%|          | 0/180 [01:02<?, ?it/s, loss=0.398]Epoch 1/5:   0%|          | 0/180 [01:03<?, ?it/s, loss=0.669]Epoch 1/5:   0%|          | 0/180 [01:03<?, ?it/s, loss=0.682]Epoch 1/5:   0%|          | 0/180 [01:04<?, ?it/s, loss=0.575]Epoch 1/5:   0%|          | 0/180 [01:04<?, ?it/s, loss=0.731]Epoch 1/5:   0%|          | 0/180 [01:05<?, ?it/s, loss=0.501]Epoch 1/5:   0%|          | 0/180 [01:05<?, ?it/s, loss=0.403]Epoch 1/5:   0%|          | 0/180 [01:06<?, ?it/s, loss=0.666]Epoch 1/5:   0%|          | 0/180 [01:06<?, ?it/s, loss=0.698]Epoch 1/5:   0%|          | 0/180 [01:06<?, ?it/s, loss=0.397]Epoch 1/5:   0%|          | 0/180 [01:07<?, ?it/s, loss=0.697]Epoch 1/5:   0%|          | 0/180 [01:07<?, ?it/s, loss=0.49] Epoch 1/5:   0%|          | 0/180 [01:08<?, ?it/s, loss=0.472]Epoch 1/5:   0%|          | 0/180 [01:08<?, ?it/s, loss=0.787]Epoch 1/5:   0%|          | 0/180 [01:09<?, ?it/s, loss=0.464]Epoch 1/5:   0%|          | 0/180 [01:09<?, ?it/s, loss=0.547]Epoch 1/5:   0%|          | 0/180 [01:10<?, ?it/s, loss=0.878]Epoch 1/5:   0%|          | 0/180 [01:10<?, ?it/s, loss=0.55] Epoch 1/5:   0%|          | 0/180 [01:11<?, ?it/s, loss=0.669]Epoch 1/5:   0%|          | 0/180 [01:11<?, ?it/s, loss=0.675]Epoch 1/5:   0%|          | 0/180 [01:12<?, ?it/s, loss=0.569]Epoch 1/5:   0%|          | 0/180 [01:12<?, ?it/s, loss=0.678]Epoch 1/5:   0%|          | 0/180 [01:13<?, ?it/s, loss=0.461]Epoch 1/5:   0%|          | 0/180 [01:13<?, ?it/s, loss=0.65] Epoch 1/5:   0%|          | 0/180 [01:14<?, ?it/s, loss=0.563]Epoch 1/5:   0%|          | 0/180 [01:14<?, ?it/s, loss=0.466]Epoch 1/5:   0%|          | 0/180 [01:15<?, ?it/s, loss=0.461]Epoch 1/5:   0%|          | 0/180 [01:15<?, ?it/s, loss=0.783]Epoch 1/5:   0%|          | 0/180 [01:16<?, ?it/s, loss=0.79] Epoch 1/5:   0%|          | 0/180 [01:16<?, ?it/s, loss=0.802]Epoch 1/5:   0%|          | 0/180 [01:16<?, ?it/s, loss=0.579]Epoch 1/5:   0%|          | 0/180 [01:17<?, ?it/s, loss=0.67] Epoch 1/5:   0%|          | 0/180 [01:17<?, ?it/s, loss=0.464]Epoch 1/5:   0%|          | 0/180 [01:18<?, ?it/s, loss=0.556]Epoch 1/5:   0%|          | 0/180 [01:18<?, ?it/s, loss=0.669]Epoch 1/5:   0%|          | 0/180 [01:19<?, ?it/s, loss=0.557]Epoch 1/5:   0%|          | 0/180 [01:19<?, ?it/s, loss=0.752]Epoch 1/5:   0%|          | 0/180 [01:20<?, ?it/s, loss=0.647]Epoch 1/5:   0%|          | 0/180 [01:20<?, ?it/s, loss=0.893]Epoch 1/5:   0%|          | 0/180 [01:21<?, ?it/s, loss=0.792]Epoch 1/5:   0%|          | 0/180 [01:21<?, ?it/s, loss=0.672]Epoch 1/5:   0%|          | 0/180 [01:22<?, ?it/s, loss=0.484]Epoch 1/5:   0%|          | 0/180 [01:22<?, ?it/s, loss=0.763]Epoch 1/5:   0%|          | 0/180 [01:23<?, ?it/s, loss=0.636]Epoch 1/5:   0%|          | 0/180 [01:23<?, ?it/s, loss=0.479]Epoch 1/5:   0%|          | 0/180 [01:24<?, ?it/s, loss=0.652]Epoch 1/5:   0%|          | 0/180 [01:24<?, ?it/s, loss=0.842]Epoch 1/5:   0%|          | 0/180 [01:25<?, ?it/s, loss=0.854]Epoch 1/5 - Loss: 114.7599 - Train Acc: 0.6729 - Val Acc: 0.6611

Analyzing router:   0%|          | 0/180 [00:00<?, ?it/s][A
Analyzing router:   1%|          | 2/180 [00:00<00:09, 18.77it/s][A
Analyzing router:   2%|▏         | 4/180 [00:00<00:09, 18.98it/s][A
Analyzing router:   3%|▎         | 6/180 [00:00<00:09, 19.16it/s][A
Analyzing router:   4%|▍         | 8/180 [00:00<00:09, 18.94it/s][A
Analyzing router:   6%|▌         | 10/180 [00:00<00:08, 19.00it/s][A
Analyzing router:   7%|▋         | 12/180 [00:00<00:08, 18.68it/s][A
Analyzing router:   8%|▊         | 14/180 [00:00<00:08, 18.68it/s][A
Analyzing router:   9%|▉         | 16/180 [00:00<00:08, 18.63it/s][A
Analyzing router:  10%|█         | 18/180 [00:00<00:08, 18.49it/s][A
Analyzing router:  11%|█         | 20/180 [00:01<00:08, 18.36it/s][A
Analyzing router:  13%|█▎        | 23/180 [00:01<00:08, 18.87it/s][A
Analyzing router:  14%|█▍        | 26/180 [00:01<00:07, 19.39it/s][A
Analyzing router:  16%|█▌        | 28/180 [00:01<00:08, 18.95it/s][A
Analyzing router:  17%|█▋        | 30/180 [00:01<00:07, 18.97it/s][A
Analyzing router:  18%|█▊        | 32/180 [00:01<00:07, 18.86it/s][A
Analyzing router:  19%|█▉        | 34/180 [00:01<00:07, 18.75it/s][A
Analyzing router:  20%|██        | 36/180 [00:01<00:07, 18.83it/s][A
Analyzing router:  21%|██        | 38/180 [00:02<00:07, 18.76it/s][A
Analyzing router:  22%|██▏       | 40/180 [00:02<00:07, 18.98it/s][A
Analyzing router:  24%|██▍       | 43/180 [00:02<00:07, 19.48it/s][A
Analyzing router:  25%|██▌       | 45/180 [00:02<00:06, 19.31it/s][A
Analyzing router:  27%|██▋       | 48/180 [00:02<00:06, 19.72it/s][A
Analyzing router:  28%|██▊       | 50/180 [00:02<00:06, 19.48it/s][A
Analyzing router:  29%|██▉       | 52/180 [00:02<00:06, 19.10it/s][A
Analyzing router:  30%|███       | 54/180 [00:02<00:06, 18.66it/s][A
Analyzing router:  31%|███       | 56/180 [00:02<00:06, 18.51it/s][A
Analyzing router:  32%|███▏      | 58/180 [00:03<00:06, 18.52it/s][A
Analyzing router:  33%|███▎      | 60/180 [00:03<00:06, 18.37it/s][A
Analyzing router:  34%|███▍      | 62/180 [00:03<00:06, 18.50it/s][A
Analyzing router:  36%|███▌      | 64/180 [00:03<00:06, 18.86it/s][A
Analyzing router:  37%|███▋      | 66/180 [00:03<00:06, 18.55it/s][A
Analyzing router:  38%|███▊      | 68/180 [00:03<00:05, 18.84it/s][A
Analyzing router:  39%|███▉      | 70/180 [00:03<00:05, 18.90it/s][A
Analyzing router:  40%|████      | 72/180 [00:03<00:05, 18.99it/s][A
Analyzing router:  41%|████      | 74/180 [00:03<00:05, 18.82it/s][A
Analyzing router:  42%|████▏     | 76/180 [00:04<00:05, 18.91it/s][A
Analyzing router:  43%|████▎     | 78/180 [00:04<00:05, 18.72it/s][A
Analyzing router:  44%|████▍     | 80/180 [00:04<00:05, 18.94it/s][A
Analyzing router:  46%|████▌     | 82/180 [00:04<00:05, 19.07it/s][A
Analyzing router:  47%|████▋     | 84/180 [00:04<00:05, 18.58it/s][A
Analyzing router:  48%|████▊     | 86/180 [00:04<00:05, 18.55it/s][A
Analyzing router:  49%|████▉     | 89/180 [00:04<00:04, 19.04it/s][A
Analyzing router:  51%|█████     | 92/180 [00:04<00:04, 19.16it/s][A
Analyzing router:  52%|█████▏    | 94/180 [00:04<00:04, 19.12it/s][A
Analyzing router:  53%|█████▎    | 96/180 [00:05<00:04, 19.31it/s][A
Analyzing router:  54%|█████▍    | 98/180 [00:05<00:04, 19.06it/s][A
Analyzing router:  56%|█████▌    | 100/180 [00:05<00:04, 19.21it/s][A
Analyzing router:  57%|█████▋    | 102/180 [00:05<00:04, 19.11it/s][A
Analyzing router:  58%|█████▊    | 104/180 [00:05<00:04, 18.94it/s][A
Analyzing router:  59%|█████▉    | 107/180 [00:05<00:03, 19.59it/s][A
Analyzing router:  61%|██████    | 109/180 [00:05<00:03, 19.43it/s][A
Analyzing router:  62%|██████▏   | 111/180 [00:05<00:03, 18.98it/s][A
Analyzing router:  63%|██████▎   | 113/180 [00:05<00:03, 18.93it/s][A
Analyzing router:  64%|██████▍   | 115/180 [00:06<00:03, 19.08it/s][A
Analyzing router:  65%|██████▌   | 117/180 [00:06<00:03, 18.89it/s][A
Analyzing router:  66%|██████▌   | 119/180 [00:06<00:03, 18.89it/s][A
Analyzing router:  68%|██████▊   | 122/180 [00:06<00:03, 19.06it/s][A
Analyzing router:  69%|██████▉   | 124/180 [00:06<00:02, 19.07it/s][A
Analyzing router:  70%|███████   | 126/180 [00:06<00:02, 18.78it/s][A
Analyzing router:  71%|███████   | 128/180 [00:06<00:02, 18.20it/s][A
Analyzing router:  72%|███████▏  | 130/180 [00:06<00:02, 18.54it/s][A
Analyzing router:  73%|███████▎  | 132/180 [00:06<00:02, 18.56it/s][A
Analyzing router:  74%|███████▍  | 134/180 [00:07<00:02, 18.44it/s][A
Analyzing router:  76%|███████▌  | 136/180 [00:07<00:02, 18.61it/s][A
Analyzing router:  77%|███████▋  | 138/180 [00:07<00:02, 18.58it/s][A
Analyzing router:  78%|███████▊  | 140/180 [00:07<00:02, 18.55it/s][A
Analyzing router:  79%|███████▉  | 142/180 [00:07<00:02, 18.61it/s][A
Analyzing router:  80%|████████  | 144/180 [00:07<00:01, 18.48it/s][A
Analyzing router:  81%|████████  | 146/180 [00:07<00:01, 18.36it/s][A
Analyzing router:  82%|████████▏ | 148/180 [00:07<00:01, 18.35it/s][A
Analyzing router:  83%|████████▎ | 150/180 [00:07<00:01, 18.52it/s][A
Analyzing router:  84%|████████▍ | 152/180 [00:08<00:01, 18.26it/s][A
Analyzing router:  86%|████████▌ | 154/180 [00:08<00:01, 17.96it/s][A
Analyzing router:  87%|████████▋ | 156/180 [00:08<00:01, 18.44it/s][A
Analyzing router:  88%|████████▊ | 159/180 [00:08<00:01, 18.97it/s][A
Analyzing router:  89%|████████▉ | 161/180 [00:08<00:01, 18.80it/s][A
Analyzing router:  91%|█████████ | 163/180 [00:08<00:00, 18.63it/s][A
Analyzing router:  92%|█████████▏| 165/180 [00:08<00:00, 18.63it/s][A
Analyzing router:  93%|█████████▎| 167/180 [00:08<00:00, 18.71it/s][A
Analyzing router:  94%|█████████▍| 170/180 [00:09<00:00, 19.03it/s][A
Analyzing router:  96%|█████████▌| 172/180 [00:09<00:00, 18.55it/s][A
Analyzing router:  97%|█████████▋| 174/180 [00:09<00:00, 18.58it/s][A
Analyzing router:  98%|█████████▊| 176/180 [00:09<00:00, 18.57it/s][A
Analyzing router:  99%|█████████▉| 178/180 [00:09<00:00, 18.58it/s][A
Analyzing router: 100%|██████████| 180/180 [00:09<00:00, 18.86it/s][AAnalyzing router: 100%|██████████| 180/180 [00:09<00:00, 18.82it/s]
🔍 Router Argmax Selection Distribution (Hard Routing):
Expert 5: 1440 samples (100.00%)

📊 Router Softmax Weights Distribution (Soft Routing):
Expert 0: average weight = 0.0853
Expert 1: average weight = 0.1758
Expert 2: average weight = 0.1372
Expert 3: average weight = 0.1209
Expert 4: average weight = 0.2195
Expert 5: average weight = 0.2614
✅ Saved best model at epoch 1 with val acc 0.6611

Epoch 2/5:   0%|          | 0/180 [00:00<?, ?it/s][A                                                              
Epoch 2/5:   0%|          | 0/180 [00:00<?, ?it/s, loss=0.657][A
Epoch 2/5:   0%|          | 0/180 [00:00<?, ?it/s, loss=0.589][A
Epoch 2/5:   0%|          | 0/180 [00:01<?, ?it/s, loss=0.56] [A
Epoch 2/5:   0%|          | 0/180 [00:01<?, ?it/s, loss=0.577][A
Epoch 2/5:   0%|          | 0/180 [00:02<?, ?it/s, loss=0.52] [A
Epoch 2/5:   0%|          | 0/180 [00:02<?, ?it/s, loss=0.517][A
Epoch 2/5:   0%|          | 0/180 [00:03<?, ?it/s, loss=0.669][A
Epoch 2/5:   0%|          | 0/180 [00:03<?, ?it/s, loss=0.814][A
Epoch 2/5:   0%|          | 0/180 [00:04<?, ?it/s, loss=0.583][A
Epoch 2/5:   0%|          | 0/180 [00:04<?, ?it/s, loss=0.57] [A
Epoch 2/5:   0%|          | 0/180 [00:05<?, ?it/s, loss=0.507][A
Epoch 2/5:   0%|          | 0/180 [00:05<?, ?it/s, loss=0.708][A
Epoch 2/5:   0%|          | 0/180 [00:05<?, ?it/s, loss=0.413][A
Epoch 2/5:   0%|          | 0/180 [00:06<?, ?it/s, loss=0.488][A
Epoch 2/5:   0%|          | 0/180 [00:06<?, ?it/s, loss=0.659][A
Epoch 2/5:   0%|          | 0/180 [00:07<?, ?it/s, loss=0.589][A
Epoch 2/5:   0%|          | 0/180 [00:07<?, ?it/s, loss=0.732][A
Epoch 2/5:   0%|          | 0/180 [00:08<?, ?it/s, loss=0.75] [A
Epoch 2/5:   0%|          | 0/180 [00:08<?, ?it/s, loss=0.753][A
Epoch 2/5:   0%|          | 0/180 [00:09<?, ?it/s, loss=0.487][A
Epoch 2/5:   0%|          | 0/180 [00:09<?, ?it/s, loss=0.585][A
Epoch 2/5:   0%|          | 0/180 [00:10<?, ?it/s, loss=0.75] [A
Epoch 2/5:   0%|          | 0/180 [00:10<?, ?it/s, loss=0.501][A
Epoch 2/5:   0%|          | 0/180 [00:11<?, ?it/s, loss=0.557][A
Epoch 2/5:   0%|          | 0/180 [00:11<?, ?it/s, loss=0.594][A
Epoch 2/5:   0%|          | 0/180 [00:12<?, ?it/s, loss=0.549][A
Epoch 2/5:   0%|          | 0/180 [00:12<?, ?it/s, loss=0.686][A
Epoch 2/5:   0%|          | 0/180 [00:12<?, ?it/s, loss=0.757][A
Epoch 2/5:   0%|          | 0/180 [00:13<?, ?it/s, loss=0.858][A
Epoch 2/5:   0%|          | 0/180 [00:13<?, ?it/s, loss=0.619][A
Epoch 2/5:   0%|          | 0/180 [00:14<?, ?it/s, loss=0.662][A
Epoch 2/5:   0%|          | 0/180 [00:14<?, ?it/s, loss=0.444][A
Epoch 2/5:   0%|          | 0/180 [00:15<?, ?it/s, loss=0.497][A
Epoch 2/5:   0%|          | 0/180 [00:15<?, ?it/s, loss=0.778][A
Epoch 2/5:   0%|          | 0/180 [00:16<?, ?it/s, loss=0.564][A
Epoch 2/5:   0%|          | 0/180 [00:16<?, ?it/s, loss=0.669][A
Epoch 2/5:   0%|          | 0/180 [00:17<?, ?it/s, loss=0.581][A
Epoch 2/5:   0%|          | 0/180 [00:17<?, ?it/s, loss=0.772][A
Epoch 2/5:   0%|          | 0/180 [00:17<?, ?it/s, loss=0.606][A
Epoch 2/5:   0%|          | 0/180 [00:18<?, ?it/s, loss=0.38] [A
Epoch 2/5:   0%|          | 0/180 [00:18<?, ?it/s, loss=0.482][A
Epoch 2/5:   0%|          | 0/180 [00:19<?, ?it/s, loss=0.618][A
Epoch 2/5:   0%|          | 0/180 [00:19<?, ?it/s, loss=0.721][A
Epoch 2/5:   0%|          | 0/180 [00:20<?, ?it/s, loss=0.549][A
Epoch 2/5:   0%|          | 0/180 [00:20<?, ?it/s, loss=0.688][A
Epoch 2/5:   0%|          | 0/180 [00:21<?, ?it/s, loss=0.664][A
Epoch 2/5:   0%|          | 0/180 [00:21<?, ?it/s, loss=0.581][A
Epoch 2/5:   0%|          | 0/180 [00:22<?, ?it/s, loss=0.435][A
Epoch 2/5:   0%|          | 0/180 [00:22<?, ?it/s, loss=0.731][A
Epoch 2/5:   0%|          | 0/180 [00:23<?, ?it/s, loss=0.721][A
Epoch 2/5:   0%|          | 0/180 [00:23<?, ?it/s, loss=0.658][A
Epoch 2/5:   0%|          | 0/180 [00:24<?, ?it/s, loss=0.422][A
Epoch 2/5:   0%|          | 0/180 [00:24<?, ?it/s, loss=0.506][A
Epoch 2/5:   0%|          | 0/180 [00:24<?, ?it/s, loss=0.823][A
Epoch 2/5:   0%|          | 0/180 [00:25<?, ?it/s, loss=0.477][A
Epoch 2/5:   0%|          | 0/180 [00:25<?, ?it/s, loss=0.831][A
Epoch 2/5:   0%|          | 0/180 [00:26<?, ?it/s, loss=0.474][A
Epoch 2/5:   0%|          | 0/180 [00:26<?, ?it/s, loss=0.479][A
Epoch 2/5:   0%|          | 0/180 [00:27<?, ?it/s, loss=0.579][A
Epoch 2/5:   0%|          | 0/180 [00:27<?, ?it/s, loss=0.48] [A
Epoch 2/5:   0%|          | 0/180 [00:28<?, ?it/s, loss=0.662][A
Epoch 2/5:   0%|          | 0/180 [00:28<?, ?it/s, loss=0.812][A
Epoch 2/5:   0%|          | 0/180 [00:29<?, ?it/s, loss=0.786][A
Epoch 2/5:   0%|          | 0/180 [00:29<?, ?it/s, loss=0.657][A
Epoch 2/5:   0%|          | 0/180 [00:30<?, ?it/s, loss=0.552][A
Epoch 2/5:   0%|          | 0/180 [00:30<?, ?it/s, loss=0.539][A
Epoch 2/5:   0%|          | 0/180 [00:31<?, ?it/s, loss=0.539][A
Epoch 2/5:   0%|          | 0/180 [00:31<?, ?it/s, loss=0.667][A
Epoch 2/5:   0%|          | 0/180 [00:31<?, ?it/s, loss=0.588][A
Epoch 2/5:   0%|          | 0/180 [00:32<?, ?it/s, loss=0.641][A
Epoch 2/5:   0%|          | 0/180 [00:32<?, ?it/s, loss=0.782][A
Epoch 2/5:   0%|          | 0/180 [00:33<?, ?it/s, loss=0.654][A
Epoch 2/5:   0%|          | 0/180 [00:33<?, ?it/s, loss=0.431][A
Epoch 2/5:   0%|          | 0/180 [00:34<?, ?it/s, loss=0.478][A
Epoch 2/5:   0%|          | 0/180 [00:34<?, ?it/s, loss=0.471][A
Epoch 2/5:   0%|          | 0/180 [00:35<?, ?it/s, loss=0.462][A
Epoch 2/5:   0%|          | 0/180 [00:35<?, ?it/s, loss=0.588][A
Epoch 2/5:   0%|          | 0/180 [00:36<?, ?it/s, loss=0.471][A
Epoch 2/5:   0%|          | 0/180 [00:36<?, ?it/s, loss=0.66] [A
Epoch 2/5:   0%|          | 0/180 [00:37<?, ?it/s, loss=0.705][A
Epoch 2/5:   0%|          | 0/180 [00:37<?, ?it/s, loss=0.718][A
Epoch 2/5:   0%|          | 0/180 [00:38<?, ?it/s, loss=0.555][A
Epoch 2/5:   0%|          | 0/180 [00:38<?, ?it/s, loss=0.662][A
Epoch 2/5:   0%|          | 0/180 [00:38<?, ?it/s, loss=0.845][A
Epoch 2/5:   0%|          | 0/180 [00:39<?, ?it/s, loss=0.597][A
Epoch 2/5:   0%|          | 0/180 [00:39<?, ?it/s, loss=0.965][A
Epoch 2/5:   0%|          | 0/180 [00:40<?, ?it/s, loss=0.57] [A
Epoch 2/5:   0%|          | 0/180 [00:40<?, ?it/s, loss=0.68][A
Epoch 2/5:   0%|          | 0/180 [00:41<?, ?it/s, loss=0.654][A
Epoch 2/5:   0%|          | 0/180 [00:41<?, ?it/s, loss=0.474][A
Epoch 2/5:   0%|          | 0/180 [00:42<?, ?it/s, loss=0.872][A
Epoch 2/5:   0%|          | 0/180 [00:42<?, ?it/s, loss=0.594][A
Epoch 2/5:   0%|          | 0/180 [00:43<?, ?it/s, loss=0.653][A
Epoch 2/5:   0%|          | 0/180 [00:43<?, ?it/s, loss=0.723][A
Epoch 2/5:   0%|          | 0/180 [00:44<?, ?it/s, loss=0.521][A
Epoch 2/5:   0%|          | 0/180 [00:44<?, ?it/s, loss=0.581][A
Epoch 2/5:   0%|          | 0/180 [00:44<?, ?it/s, loss=0.735][A
Epoch 2/5:   0%|          | 0/180 [00:45<?, ?it/s, loss=0.709][A
Epoch 2/5:   0%|          | 0/180 [00:45<?, ?it/s, loss=0.645][A
Epoch 2/5:   0%|          | 0/180 [00:46<?, ?it/s, loss=0.524][A
Epoch 2/5:   0%|          | 0/180 [00:46<?, ?it/s, loss=0.61] [A
Epoch 2/5:   0%|          | 0/180 [00:47<?, ?it/s, loss=0.727][A
Epoch 2/5:   0%|          | 0/180 [00:47<?, ?it/s, loss=0.577][A
Epoch 2/5:   0%|          | 0/180 [00:48<?, ?it/s, loss=0.759][A
Epoch 2/5:   0%|          | 0/180 [00:48<?, ?it/s, loss=0.655][A
Epoch 2/5:   0%|          | 0/180 [00:49<?, ?it/s, loss=0.596][A
Epoch 2/5:   0%|          | 0/180 [00:49<?, ?it/s, loss=0.507][A
Epoch 2/5:   0%|          | 0/180 [00:50<?, ?it/s, loss=0.692][A
Epoch 2/5:   0%|          | 0/180 [00:50<?, ?it/s, loss=0.718][A
Epoch 2/5:   0%|          | 0/180 [00:51<?, ?it/s, loss=0.747][A
Epoch 2/5:   0%|          | 0/180 [00:51<?, ?it/s, loss=0.599][A
Epoch 2/5:   0%|          | 0/180 [00:52<?, ?it/s, loss=0.641][A
Epoch 2/5:   0%|          | 0/180 [00:52<?, ?it/s, loss=0.682][A
Epoch 2/5:   0%|          | 0/180 [00:52<?, ?it/s, loss=0.572][A
Epoch 2/5:   0%|          | 0/180 [00:53<?, ?it/s, loss=0.591][A
Epoch 2/5:   0%|          | 0/180 [00:53<?, ?it/s, loss=0.626][A
Epoch 2/5:   0%|          | 0/180 [00:54<?, ?it/s, loss=0.589][A
Epoch 2/5:   0%|          | 0/180 [00:54<?, ?it/s, loss=0.595][A
Epoch 2/5:   0%|          | 0/180 [00:55<?, ?it/s, loss=0.469][A
Epoch 2/5:   0%|          | 0/180 [00:55<?, ?it/s, loss=0.733][A
Epoch 2/5:   0%|          | 0/180 [00:56<?, ?it/s, loss=0.734][A
Epoch 2/5:   0%|          | 0/180 [00:56<?, ?it/s, loss=0.599][A
Epoch 2/5:   0%|          | 0/180 [00:57<?, ?it/s, loss=0.651][A
Epoch 2/5:   0%|          | 0/180 [00:57<?, ?it/s, loss=0.514][A
Epoch 2/5:   0%|          | 0/180 [00:58<?, ?it/s, loss=0.659][A
Epoch 2/5:   0%|          | 0/180 [00:58<?, ?it/s, loss=0.769][A
Epoch 2/5:   0%|          | 0/180 [00:59<?, ?it/s, loss=0.583][A
Epoch 2/5:   0%|          | 0/180 [00:59<?, ?it/s, loss=0.678][A
Epoch 2/5:   0%|          | 0/180 [00:59<?, ?it/s, loss=0.428][A
Epoch 2/5:   0%|          | 0/180 [01:00<?, ?it/s, loss=0.592][A
Epoch 2/5:   0%|          | 0/180 [01:00<?, ?it/s, loss=0.702][A
Epoch 2/5:   0%|          | 0/180 [01:01<?, ?it/s, loss=0.667][A
Epoch 2/5:   0%|          | 0/180 [01:01<?, ?it/s, loss=0.41] [A
Epoch 2/5:   0%|          | 0/180 [01:02<?, ?it/s, loss=0.751][A
Epoch 2/5:   0%|          | 0/180 [01:02<?, ?it/s, loss=0.581][A
Epoch 2/5:   0%|          | 0/180 [01:03<?, ?it/s, loss=0.655][A
Epoch 2/5:   0%|          | 0/180 [01:03<?, ?it/s, loss=0.728][A
Epoch 2/5:   0%|          | 0/180 [01:04<?, ?it/s, loss=0.784][A
Epoch 2/5:   0%|          | 0/180 [01:04<?, ?it/s, loss=0.696][A
Epoch 2/5:   0%|          | 0/180 [01:05<?, ?it/s, loss=0.763][A
Epoch 2/5:   0%|          | 0/180 [01:05<?, ?it/s, loss=0.579][A
Epoch 2/5:   0%|          | 0/180 [01:06<?, ?it/s, loss=0.5]  [A
Epoch 2/5:   0%|          | 0/180 [01:06<?, ?it/s, loss=0.586][A
Epoch 2/5:   0%|          | 0/180 [01:06<?, ?it/s, loss=0.474][A
Epoch 2/5:   0%|          | 0/180 [01:07<?, ?it/s, loss=0.572][A
Epoch 2/5:   0%|          | 0/180 [01:07<?, ?it/s, loss=0.556][A
Epoch 2/5:   0%|          | 0/180 [01:08<?, ?it/s, loss=0.469][A
Epoch 2/5:   0%|          | 0/180 [01:08<?, ?it/s, loss=0.549][A
Epoch 2/5:   0%|          | 0/180 [01:09<?, ?it/s, loss=0.679][A
Epoch 2/5:   0%|          | 0/180 [01:09<?, ?it/s, loss=0.566][A
Epoch 2/5:   0%|          | 0/180 [01:10<?, ?it/s, loss=0.451][A
Epoch 2/5:   0%|          | 0/180 [01:10<?, ?it/s, loss=0.784][A
Epoch 2/5:   0%|          | 0/180 [01:11<?, ?it/s, loss=0.656][A
Epoch 2/5:   0%|          | 0/180 [01:11<?, ?it/s, loss=0.579][A
Epoch 2/5:   0%|          | 0/180 [01:12<?, ?it/s, loss=0.775][A
Epoch 2/5:   0%|          | 0/180 [01:12<?, ?it/s, loss=0.684][A
Epoch 2/5:   0%|          | 0/180 [01:12<?, ?it/s, loss=0.76] [A
Epoch 2/5:   0%|          | 0/180 [01:13<?, ?it/s, loss=0.563][A
Epoch 2/5:   0%|          | 0/180 [01:13<?, ?it/s, loss=0.577][A
Epoch 2/5:   0%|          | 0/180 [01:14<?, ?it/s, loss=1.04] [A
Epoch 2/5:   0%|          | 0/180 [01:14<?, ?it/s, loss=0.465][A
Epoch 2/5:   0%|          | 0/180 [01:15<?, ?it/s, loss=0.741][A
Epoch 2/5:   0%|          | 0/180 [01:15<?, ?it/s, loss=0.694][A
Epoch 2/5:   0%|          | 0/180 [01:16<?, ?it/s, loss=0.591][A
Epoch 2/5:   0%|          | 0/180 [01:16<?, ?it/s, loss=0.506][A
Epoch 2/5:   0%|          | 0/180 [01:17<?, ?it/s, loss=0.632][A
Epoch 2/5:   0%|          | 0/180 [01:17<?, ?it/s, loss=0.66] [A
Epoch 2/5:   0%|          | 0/180 [01:18<?, ?it/s, loss=0.473][A
Epoch 2/5:   0%|          | 0/180 [01:18<?, ?it/s, loss=0.773][A
Epoch 2/5:   0%|          | 0/180 [01:19<?, ?it/s, loss=0.821][A
Epoch 2/5:   0%|          | 0/180 [01:19<?, ?it/s, loss=0.402][A
Epoch 2/5:   0%|          | 0/180 [01:19<?, ?it/s, loss=0.761][A
Epoch 2/5:   0%|          | 0/180 [01:20<?, ?it/s, loss=0.79] [A
Epoch 2/5:   0%|          | 0/180 [01:20<?, ?it/s, loss=0.605][A
Epoch 2/5:   0%|          | 0/180 [01:21<?, ?it/s, loss=0.63] [A
Epoch 2/5:   0%|          | 0/180 [01:21<?, ?it/s, loss=0.633][A
Epoch 2/5:   0%|          | 0/180 [01:22<?, ?it/s, loss=0.392][A
Epoch 2/5:   0%|          | 0/180 [01:22<?, ?it/s, loss=0.735][A
Epoch 2/5:   0%|          | 0/180 [01:23<?, ?it/s, loss=0.566][A
Epoch 2/5:   0%|          | 0/180 [01:23<?, ?it/s, loss=0.568][AEpoch 2/5 - Loss: 112.3556 - Train Acc: 0.6792 - Val Acc: 0.6611
Analyzing router:   0%|          | 0/180 [00:00<?, ?it/s]Analyzing router:   1%|          | 2/180 [00:00<00:09, 18.76it/s]Analyzing router:   2%|▏         | 4/180 [00:00<00:09, 18.93it/s]Analyzing router:   3%|▎         | 6/180 [00:00<00:09, 18.80it/s]Analyzing router:   4%|▍         | 8/180 [00:00<00:09, 18.78it/s]Analyzing router:   6%|▌         | 10/180 [00:00<00:08, 18.95it/s]Analyzing router:   7%|▋         | 12/180 [00:00<00:08, 18.89it/s]Analyzing router:   8%|▊         | 14/180 [00:00<00:08, 18.89it/s]Analyzing router:   9%|▉         | 16/180 [00:00<00:08, 18.93it/s]Analyzing router:  10%|█         | 18/180 [00:00<00:08, 19.17it/s]Analyzing router:  11%|█         | 20/180 [00:01<00:08, 19.23it/s]Analyzing router:  12%|█▏        | 22/180 [00:01<00:08, 18.93it/s]Analyzing router:  13%|█▎        | 24/180 [00:01<00:08, 18.92it/s]Analyzing router:  14%|█▍        | 26/180 [00:01<00:08, 18.87it/s]Analyzing router:  16%|█▌        | 28/180 [00:01<00:08, 18.71it/s]Analyzing router:  17%|█▋        | 30/180 [00:01<00:07, 18.79it/s]Analyzing router:  18%|█▊        | 32/180 [00:01<00:07, 19.05it/s]Analyzing router:  19%|█▉        | 34/180 [00:01<00:07, 18.94it/s]Analyzing router:  20%|██        | 36/180 [00:01<00:07, 18.66it/s]Analyzing router:  21%|██        | 38/180 [00:02<00:07, 18.92it/s]Analyzing router:  22%|██▏       | 40/180 [00:02<00:07, 18.92it/s]Analyzing router:  23%|██▎       | 42/180 [00:02<00:07, 18.80it/s]Analyzing router:  24%|██▍       | 44/180 [00:02<00:07, 18.82it/s]Analyzing router:  26%|██▌       | 46/180 [00:02<00:07, 18.77it/s]Analyzing router:  27%|██▋       | 48/180 [00:02<00:06, 19.12it/s]Analyzing router:  28%|██▊       | 50/180 [00:02<00:06, 19.38it/s]Analyzing router:  29%|██▉       | 52/180 [00:02<00:06, 19.40it/s]Analyzing router:  31%|███       | 55/180 [00:02<00:06, 19.65it/s]Analyzing router:  32%|███▏      | 57/180 [00:02<00:06, 19.26it/s]Analyzing router:  33%|███▎      | 59/180 [00:03<00:06, 19.24it/s]Analyzing router:  34%|███▍      | 61/180 [00:03<00:06, 19.05it/s]Analyzing router:  35%|███▌      | 63/180 [00:03<00:06, 19.04it/s]Analyzing router:  36%|███▌      | 65/180 [00:03<00:06, 18.85it/s]Analyzing router:  37%|███▋      | 67/180 [00:03<00:05, 19.05it/s]Analyzing router:  38%|███▊      | 69/180 [00:03<00:05, 19.01it/s]Analyzing router:  39%|███▉      | 71/180 [00:03<00:05, 18.91it/s]Analyzing router:  41%|████      | 73/180 [00:03<00:05, 18.93it/s]Analyzing router:  42%|████▏     | 75/180 [00:03<00:05, 18.83it/s]Analyzing router:  43%|████▎     | 77/180 [00:04<00:05, 18.78it/s]Analyzing router:  44%|████▍     | 79/180 [00:04<00:05, 18.86it/s]Analyzing router:  45%|████▌     | 81/180 [00:04<00:05, 18.60it/s]Analyzing router:  46%|████▌     | 83/180 [00:04<00:05, 18.48it/s]Analyzing router:  48%|████▊     | 86/180 [00:04<00:04, 19.13it/s]Analyzing router:  49%|████▉     | 88/180 [00:04<00:04, 19.08it/s]Analyzing router:  50%|█████     | 90/180 [00:04<00:04, 18.78it/s]Analyzing router:  52%|█████▏    | 93/180 [00:04<00:04, 19.06it/s]Analyzing router:  53%|█████▎    | 95/180 [00:05<00:04, 18.98it/s]Analyzing router:  54%|█████▍    | 97/180 [00:05<00:04, 18.72it/s]Analyzing router:  55%|█████▌    | 99/180 [00:05<00:04, 18.65it/s]Analyzing router:  56%|█████▌    | 101/180 [00:05<00:04, 18.31it/s]Analyzing router:  57%|█████▋    | 103/180 [00:05<00:04, 18.38it/s]Analyzing router:  58%|█████▊    | 105/180 [00:05<00:04, 18.53it/s]Analyzing router:  59%|█████▉    | 107/180 [00:05<00:03, 18.72it/s]Analyzing router:  61%|██████    | 109/180 [00:05<00:03, 18.41it/s]Analyzing router:  62%|██████▏   | 111/180 [00:05<00:03, 18.58it/s]Analyzing router:  63%|██████▎   | 113/180 [00:05<00:03, 18.73it/s]Analyzing router:  64%|██████▍   | 116/180 [00:06<00:03, 19.25it/s]Analyzing router:  66%|██████▌   | 118/180 [00:06<00:03, 19.24it/s]Analyzing router:  67%|██████▋   | 120/180 [00:06<00:03, 19.06it/s]Analyzing router:  68%|██████▊   | 122/180 [00:06<00:03, 19.14it/s]Analyzing router:  69%|██████▉   | 124/180 [00:06<00:03, 18.60it/s]Analyzing router:  70%|███████   | 126/180 [00:06<00:02, 18.31it/s]Analyzing router:  71%|███████   | 128/180 [00:06<00:02, 18.45it/s]Analyzing router:  72%|███████▏  | 130/180 [00:06<00:02, 18.37it/s]Analyzing router:  73%|███████▎  | 132/180 [00:06<00:02, 18.82it/s]Analyzing router:  74%|███████▍  | 134/180 [00:07<00:02, 18.85it/s]Analyzing router:  76%|███████▌  | 136/180 [00:07<00:02, 18.82it/s]Analyzing router:  77%|███████▋  | 138/180 [00:07<00:02, 18.74it/s]Analyzing router:  78%|███████▊  | 141/180 [00:07<00:02, 19.17it/s]Analyzing router:  79%|███████▉  | 143/180 [00:07<00:01, 18.94it/s]Analyzing router:  81%|████████  | 145/180 [00:07<00:01, 19.01it/s]Analyzing router:  82%|████████▏ | 148/180 [00:07<00:01, 19.18it/s]Analyzing router:  83%|████████▎ | 150/180 [00:07<00:01, 18.64it/s]Analyzing router:  84%|████████▍ | 152/180 [00:08<00:01, 18.60it/s]Analyzing router:  86%|████████▌ | 154/180 [00:08<00:01, 18.46it/s]Analyzing router:  87%|████████▋ | 156/180 [00:08<00:01, 18.86it/s]Analyzing router:  88%|████████▊ | 158/180 [00:08<00:01, 18.92it/s]Analyzing router:  89%|████████▉ | 160/180 [00:08<00:01, 18.81it/s]Analyzing router:  90%|█████████ | 162/180 [00:08<00:00, 18.84it/s]Analyzing router:  91%|█████████ | 164/180 [00:08<00:00, 19.00it/s]Analyzing router:  92%|█████████▏| 166/180 [00:08<00:00, 18.99it/s]Analyzing router:  93%|█████████▎| 168/180 [00:08<00:00, 18.85it/s]Analyzing router:  94%|█████████▍| 170/180 [00:09<00:00, 18.43it/s]Analyzing router:  96%|█████████▌| 172/180 [00:09<00:00, 18.55it/s]Analyzing router:  97%|█████████▋| 174/180 [00:09<00:00, 18.06it/s]Analyzing router:  98%|█████████▊| 176/180 [00:09<00:00, 17.88it/s]Analyzing router:  99%|█████████▉| 178/180 [00:09<00:00, 17.83it/s]Analyzing router: 100%|██████████| 180/180 [00:09<00:00, 17.95it/s]Analyzing router: 100%|██████████| 180/180 [00:09<00:00, 18.80it/s]
🔍 Router Argmax Selection Distribution (Hard Routing):
Expert 1: 1440 samples (100.00%)

📊 Router Softmax Weights Distribution (Soft Routing):
Expert 0: average weight = 0.1163
Expert 1: average weight = 0.2615
Expert 2: average weight = 0.1282
Expert 3: average weight = 0.1388
Expert 4: average weight = 0.1864
Expert 5: average weight = 0.1689
Epoch 3/5:   0%|          | 0/180 [00:00<?, ?it/s]
                                                              [AEpoch 3/5:   0%|          | 0/180 [00:00<?, ?it/s, loss=0.732]Epoch 3/5:   0%|          | 0/180 [00:00<?, ?it/s, loss=0.583]Epoch 3/5:   0%|          | 0/180 [00:01<?, ?it/s, loss=0.804]Epoch 3/5:   0%|          | 0/180 [00:01<?, ?it/s, loss=0.737]Epoch 3/5:   0%|          | 0/180 [00:02<?, ?it/s, loss=0.567]Epoch 3/5:   0%|          | 0/180 [00:02<?, ?it/s, loss=0.743]Epoch 3/5:   0%|          | 0/180 [00:03<?, ?it/s, loss=0.661]Epoch 3/5:   0%|          | 0/180 [00:03<?, ?it/s, loss=0.482]Epoch 3/5:   0%|          | 0/180 [00:04<?, ?it/s, loss=0.587]Epoch 3/5:   0%|          | 0/180 [00:04<?, ?it/s, loss=0.579]Epoch 3/5:   0%|          | 0/180 [00:05<?, ?it/s, loss=0.492]Epoch 3/5:   0%|          | 0/180 [00:05<?, ?it/s, loss=0.595]Epoch 3/5:   0%|          | 0/180 [00:06<?, ?it/s, loss=0.487]Epoch 3/5:   0%|          | 0/180 [00:06<?, ?it/s, loss=0.722]Epoch 3/5:   0%|          | 0/180 [00:06<?, ?it/s, loss=0.688]Epoch 3/5:   0%|          | 0/180 [00:07<?, ?it/s, loss=0.594]Epoch 3/5:   0%|          | 0/180 [00:07<?, ?it/s, loss=0.489]Epoch 3/5:   0%|          | 0/180 [00:08<?, ?it/s, loss=0.569]Epoch 3/5:   0%|          | 0/180 [00:08<?, ?it/s, loss=0.571]Epoch 3/5:   0%|          | 0/180 [00:09<?, ?it/s, loss=0.759]Epoch 3/5:   0%|          | 0/180 [00:09<?, ?it/s, loss=0.57] Epoch 3/5:   0%|          | 0/180 [00:10<?, ?it/s, loss=0.709]Epoch 3/5:   0%|          | 0/180 [00:10<?, ?it/s, loss=0.649]Epoch 3/5:   0%|          | 0/180 [00:11<?, ?it/s, loss=0.744]Epoch 3/5:   0%|          | 0/180 [00:11<?, ?it/s, loss=0.57] Epoch 3/5:   0%|          | 0/180 [00:12<?, ?it/s, loss=0.775]Epoch 3/5:   0%|          | 0/180 [00:12<?, ?it/s, loss=0.647]Epoch 3/5:   0%|          | 0/180 [00:13<?, ?it/s, loss=0.554]Epoch 3/5:   0%|          | 0/180 [00:13<?, ?it/s, loss=0.487]Epoch 3/5:   0%|          | 0/180 [00:13<?, ?it/s, loss=0.64] Epoch 3/5:   0%|          | 0/180 [00:14<?, ?it/s, loss=0.496]Epoch 3/5:   0%|          | 0/180 [00:14<?, ?it/s, loss=0.494]Epoch 3/5:   0%|          | 0/180 [00:15<?, ?it/s, loss=0.645]Epoch 3/5:   0%|          | 0/180 [00:15<?, ?it/s, loss=0.585]Epoch 3/5:   0%|          | 0/180 [00:16<?, ?it/s, loss=0.56] Epoch 3/5:   0%|          | 0/180 [00:16<?, ?it/s, loss=0.565]Epoch 3/5:   0%|          | 0/180 [00:17<?, ?it/s, loss=0.463]Epoch 3/5:   0%|          | 0/180 [00:17<?, ?it/s, loss=0.753]Epoch 3/5:   0%|          | 0/180 [00:18<?, ?it/s, loss=0.551]Epoch 3/5:   0%|          | 0/180 [00:18<?, ?it/s, loss=0.831]Epoch 3/5:   0%|          | 0/180 [00:19<?, ?it/s, loss=0.56] Epoch 3/5:   0%|          | 0/180 [00:19<?, ?it/s, loss=0.581]Epoch 3/5:   0%|          | 0/180 [00:20<?, ?it/s, loss=0.759]Epoch 3/5:   0%|          | 0/180 [00:20<?, ?it/s, loss=0.932]Epoch 3/5:   0%|          | 0/180 [00:20<?, ?it/s, loss=0.758]Epoch 3/5:   0%|          | 0/180 [00:21<?, ?it/s, loss=0.724]Epoch 3/5:   0%|          | 0/180 [00:21<?, ?it/s, loss=0.588]Epoch 3/5:   0%|          | 0/180 [00:22<?, ?it/s, loss=0.546]Epoch 3/5:   0%|          | 0/180 [00:22<?, ?it/s, loss=0.737]Epoch 3/5:   0%|          | 0/180 [00:23<?, ?it/s, loss=0.653]Epoch 3/5:   0%|          | 0/180 [00:23<?, ?it/s, loss=0.564]Epoch 3/5:   0%|          | 0/180 [00:24<?, ?it/s, loss=0.576]Epoch 3/5:   0%|          | 0/180 [00:24<?, ?it/s, loss=0.588]Epoch 3/5:   0%|          | 0/180 [00:25<?, ?it/s, loss=0.43] Epoch 3/5:   0%|          | 0/180 [00:25<?, ?it/s, loss=0.632]Epoch 3/5:   0%|          | 0/180 [00:26<?, ?it/s, loss=0.607]Epoch 3/5:   0%|          | 0/180 [00:26<?, ?it/s, loss=0.629]Epoch 3/5:   0%|          | 0/180 [00:26<?, ?it/s, loss=0.725]Epoch 3/5:   0%|          | 0/180 [00:27<?, ?it/s, loss=0.657]Epoch 3/5:   0%|          | 0/180 [00:27<?, ?it/s, loss=0.469]Epoch 3/5:   0%|          | 0/180 [00:28<?, ?it/s, loss=0.568]Epoch 3/5:   0%|          | 0/180 [00:28<?, ?it/s, loss=0.497]Epoch 3/5:   0%|          | 0/180 [00:29<?, ?it/s, loss=0.662]Epoch 3/5:   0%|          | 0/180 [00:29<?, ?it/s, loss=0.736]Epoch 3/5:   0%|          | 0/180 [00:30<?, ?it/s, loss=0.562]Epoch 3/5:   0%|          | 0/180 [00:30<?, ?it/s, loss=0.568]Epoch 3/5:   0%|          | 0/180 [00:31<?, ?it/s, loss=0.577]Epoch 3/5:   0%|          | 0/180 [00:31<?, ?it/s, loss=0.589]Epoch 3/5:   0%|          | 0/180 [00:32<?, ?it/s, loss=0.739]Epoch 3/5:   0%|          | 0/180 [00:32<?, ?it/s, loss=0.663]Epoch 3/5:   0%|          | 0/180 [00:33<?, ?it/s, loss=0.673]Epoch 3/5:   0%|          | 0/180 [00:33<?, ?it/s, loss=0.642]Epoch 3/5:   0%|          | 0/180 [00:33<?, ?it/s, loss=0.482]Epoch 3/5:   0%|          | 0/180 [00:34<?, ?it/s, loss=0.559]Epoch 3/5:   0%|          | 0/180 [00:34<?, ?it/s, loss=0.67] Epoch 3/5:   0%|          | 0/180 [00:35<?, ?it/s, loss=0.484]Epoch 3/5:   0%|          | 0/180 [00:35<?, ?it/s, loss=0.581]Epoch 3/5:   0%|          | 0/180 [00:36<?, ?it/s, loss=0.743]Epoch 3/5:   0%|          | 0/180 [00:36<?, ?it/s, loss=0.479]Epoch 3/5:   0%|          | 0/180 [00:37<?, ?it/s, loss=0.571]Epoch 3/5:   0%|          | 0/180 [00:37<?, ?it/s, loss=0.577]Epoch 3/5:   0%|          | 0/180 [00:38<?, ?it/s, loss=0.537]Epoch 3/5:   0%|          | 0/180 [00:38<?, ?it/s, loss=0.534]Epoch 3/5:   0%|          | 0/180 [00:39<?, ?it/s, loss=0.46] Epoch 3/5:   0%|          | 0/180 [00:39<?, ?it/s, loss=0.654]Epoch 3/5:   0%|          | 0/180 [00:40<?, ?it/s, loss=0.469]Epoch 3/5:   0%|          | 0/180 [00:40<?, ?it/s, loss=0.651]Epoch 3/5:   0%|          | 0/180 [00:40<?, ?it/s, loss=0.642]Epoch 3/5:   0%|          | 0/180 [00:41<?, ?it/s, loss=0.674]Epoch 3/5:   0%|          | 0/180 [00:41<?, ?it/s, loss=0.663]Epoch 3/5:   0%|          | 0/180 [00:42<?, ?it/s, loss=0.602]Epoch 3/5:   0%|          | 0/180 [00:42<?, ?it/s, loss=0.864]Epoch 3/5:   0%|          | 0/180 [00:43<?, ?it/s, loss=0.66] Epoch 3/5:   0%|          | 0/180 [00:43<?, ?it/s, loss=0.582]Epoch 3/5:   0%|          | 0/180 [00:44<?, ?it/s, loss=0.857]Epoch 3/5:   0%|          | 0/180 [00:44<?, ?it/s, loss=0.664]Epoch 3/5:   0%|          | 0/180 [00:45<?, ?it/s, loss=0.741]Epoch 3/5:   0%|          | 0/180 [00:45<?, ?it/s, loss=0.601]Epoch 3/5:   0%|          | 0/180 [00:46<?, ?it/s, loss=0.525]Epoch 3/5:   0%|          | 0/180 [00:46<?, ?it/s, loss=0.464]Epoch 3/5:   0%|          | 0/180 [00:46<?, ?it/s, loss=0.481]Epoch 3/5:   0%|          | 0/180 [00:47<?, ?it/s, loss=0.546]Epoch 3/5:   0%|          | 0/180 [00:47<?, ?it/s, loss=0.639]Epoch 3/5:   0%|          | 0/180 [00:48<?, ?it/s, loss=0.646]Epoch 3/5:   0%|          | 0/180 [00:48<?, ?it/s, loss=0.377]Epoch 3/5:   0%|          | 0/180 [00:49<?, ?it/s, loss=0.696]Epoch 3/5:   0%|          | 0/180 [00:49<?, ?it/s, loss=0.773]Epoch 3/5:   0%|          | 0/180 [00:50<?, ?it/s, loss=0.458]Epoch 3/5:   0%|          | 0/180 [00:50<?, ?it/s, loss=0.69] Epoch 3/5:   0%|          | 0/180 [00:51<?, ?it/s, loss=0.678]Epoch 3/5:   0%|          | 0/180 [00:51<?, ?it/s, loss=0.459]Epoch 3/5:   0%|          | 0/180 [00:52<?, ?it/s, loss=0.494]Epoch 3/5:   0%|          | 0/180 [00:52<?, ?it/s, loss=0.763]Epoch 3/5:   0%|          | 0/180 [00:53<?, ?it/s, loss=0.55] Epoch 3/5:   0%|          | 0/180 [00:53<?, ?it/s, loss=0.648]Epoch 3/5:   0%|          | 0/180 [00:53<?, ?it/s, loss=0.647]Epoch 3/5:   0%|          | 0/180 [00:54<?, ?it/s, loss=0.75] Epoch 3/5:   0%|          | 0/180 [00:54<?, ?it/s, loss=0.98]Epoch 3/5:   0%|          | 0/180 [00:55<?, ?it/s, loss=0.665]Epoch 3/5:   0%|          | 0/180 [00:55<?, ?it/s, loss=0.866]Epoch 3/5:   0%|          | 0/180 [00:56<?, ?it/s, loss=0.674]Epoch 3/5:   0%|          | 0/180 [00:56<?, ?it/s, loss=0.751]Epoch 3/5:   0%|          | 0/180 [00:57<?, ?it/s, loss=0.67] Epoch 3/5:   0%|          | 0/180 [00:57<?, ?it/s, loss=0.891]Epoch 3/5:   0%|          | 0/180 [00:58<?, ?it/s, loss=0.601]Epoch 3/5:   0%|          | 0/180 [00:58<?, ?it/s, loss=0.682]Epoch 3/5:   0%|          | 0/180 [00:59<?, ?it/s, loss=0.567]Epoch 3/5:   0%|          | 0/180 [00:59<?, ?it/s, loss=0.576]Epoch 3/5:   0%|          | 0/180 [00:59<?, ?it/s, loss=0.497]Epoch 3/5:   0%|          | 0/180 [01:00<?, ?it/s, loss=0.633]Epoch 3/5:   0%|          | 0/180 [01:00<?, ?it/s, loss=0.496]Epoch 3/5:   0%|          | 0/180 [01:01<?, ?it/s, loss=0.548]Epoch 3/5:   0%|          | 0/180 [01:01<?, ?it/s, loss=0.517]Epoch 3/5:   0%|          | 0/180 [01:02<?, ?it/s, loss=0.555]Epoch 3/5:   0%|          | 0/180 [01:02<?, ?it/s, loss=0.521]Epoch 3/5:   0%|          | 0/180 [01:03<?, ?it/s, loss=0.5]  Epoch 3/5:   0%|          | 0/180 [01:03<?, ?it/s, loss=0.481]Epoch 3/5:   0%|          | 0/180 [01:04<?, ?it/s, loss=0.61] Epoch 3/5:   0%|          | 0/180 [01:04<?, ?it/s, loss=0.597]Epoch 3/5:   0%|          | 0/180 [01:05<?, ?it/s, loss=0.597]Epoch 3/5:   0%|          | 0/180 [01:05<?, ?it/s, loss=0.638]Epoch 3/5:   0%|          | 0/180 [01:06<?, ?it/s, loss=0.544]Epoch 3/5:   0%|          | 0/180 [01:06<?, ?it/s, loss=0.673]Epoch 3/5:   0%|          | 0/180 [01:06<?, ?it/s, loss=0.791]Epoch 3/5:   0%|          | 0/180 [01:07<?, ?it/s, loss=0.64] Epoch 3/5:   0%|          | 0/180 [01:07<?, ?it/s, loss=0.585]Epoch 3/5:   0%|          | 0/180 [01:08<?, ?it/s, loss=0.691]Epoch 3/5:   0%|          | 0/180 [01:08<?, ?it/s, loss=0.535]Epoch 3/5:   0%|          | 0/180 [01:09<?, ?it/s, loss=0.561]Epoch 3/5:   0%|          | 0/180 [01:09<?, ?it/s, loss=0.376]Epoch 3/5:   0%|          | 0/180 [01:10<?, ?it/s, loss=0.421]Epoch 3/5:   0%|          | 0/180 [01:10<?, ?it/s, loss=0.671]Epoch 3/5:   0%|          | 0/180 [01:11<?, ?it/s, loss=0.567]Epoch 3/5:   0%|          | 0/180 [01:11<?, ?it/s, loss=0.674]Epoch 3/5:   0%|          | 0/180 [01:12<?, ?it/s, loss=0.64] Epoch 3/5:   0%|          | 0/180 [01:12<?, ?it/s, loss=0.879]Epoch 3/5:   0%|          | 0/180 [01:12<?, ?it/s, loss=0.342]Epoch 3/5:   0%|          | 0/180 [01:13<?, ?it/s, loss=0.558]Epoch 3/5:   0%|          | 0/180 [01:13<?, ?it/s, loss=0.774]Epoch 3/5:   0%|          | 0/180 [01:14<?, ?it/s, loss=0.706]Epoch 3/5:   0%|          | 0/180 [01:14<?, ?it/s, loss=0.691]Epoch 3/5:   0%|          | 0/180 [01:15<?, ?it/s, loss=0.596]Epoch 3/5:   0%|          | 0/180 [01:15<?, ?it/s, loss=0.696]Epoch 3/5:   0%|          | 0/180 [01:16<?, ?it/s, loss=0.545]Epoch 3/5:   0%|          | 0/180 [01:16<?, ?it/s, loss=0.938]Epoch 3/5:   0%|          | 0/180 [01:17<?, ?it/s, loss=0.825]Epoch 3/5:   0%|          | 0/180 [01:17<?, ?it/s, loss=0.531]Epoch 3/5:   0%|          | 0/180 [01:18<?, ?it/s, loss=0.59] Epoch 3/5:   0%|          | 0/180 [01:18<?, ?it/s, loss=0.683]Epoch 3/5:   0%|          | 0/180 [01:19<?, ?it/s, loss=0.648]Epoch 3/5:   0%|          | 0/180 [01:19<?, ?it/s, loss=0.738]Epoch 3/5:   0%|          | 0/180 [01:19<?, ?it/s, loss=0.824]Epoch 3/5:   0%|          | 0/180 [01:20<?, ?it/s, loss=0.55] Epoch 3/5:   0%|          | 0/180 [01:20<?, ?it/s, loss=0.557]Epoch 3/5:   0%|          | 0/180 [01:21<?, ?it/s, loss=0.701]Epoch 3/5:   0%|          | 0/180 [01:21<?, ?it/s, loss=0.62] Epoch 3/5:   0%|          | 0/180 [01:22<?, ?it/s, loss=0.574]Epoch 3/5:   0%|          | 0/180 [01:22<?, ?it/s, loss=0.54] Epoch 3/5:   0%|          | 0/180 [01:23<?, ?it/s, loss=0.539]Epoch 3/5:   0%|          | 0/180 [01:23<?, ?it/s, loss=0.6]  Epoch 3/5 - Loss: 111.9333 - Train Acc: 0.6792 - Val Acc: 0.6611

Analyzing router:   0%|          | 0/180 [00:00<?, ?it/s][A
Analyzing router:   1%|          | 2/180 [00:00<00:09, 19.13it/s][A
Analyzing router:   2%|▏         | 4/180 [00:00<00:09, 18.58it/s][A
Analyzing router:   3%|▎         | 6/180 [00:00<00:09, 18.86it/s][A
Analyzing router:   4%|▍         | 8/180 [00:00<00:09, 18.88it/s][A
Analyzing router:   6%|▌         | 11/180 [00:00<00:08, 19.45it/s][A
Analyzing router:   7%|▋         | 13/180 [00:00<00:08, 19.49it/s][A
Analyzing router:   8%|▊         | 15/180 [00:00<00:08, 19.43it/s][A
Analyzing router:  10%|█         | 18/180 [00:00<00:08, 19.54it/s][A
Analyzing router:  11%|█         | 20/180 [00:01<00:08, 19.07it/s][A
Analyzing router:  12%|█▏        | 22/180 [00:01<00:08, 18.84it/s][A
Analyzing router:  13%|█▎        | 24/180 [00:01<00:08, 19.11it/s][A
Analyzing router:  14%|█▍        | 26/180 [00:01<00:08, 18.79it/s][A
Analyzing router:  16%|█▌        | 28/180 [00:01<00:08, 18.74it/s][A
Analyzing router:  17%|█▋        | 30/180 [00:01<00:08, 18.73it/s][A
Analyzing router:  18%|█▊        | 32/180 [00:01<00:07, 18.59it/s][A
Analyzing router:  19%|█▉        | 34/180 [00:01<00:07, 18.30it/s][A
Analyzing router:  20%|██        | 36/180 [00:01<00:07, 18.38it/s][A
Analyzing router:  21%|██        | 38/180 [00:02<00:07, 18.16it/s][A
Analyzing router:  22%|██▏       | 40/180 [00:02<00:07, 18.30it/s][A
Analyzing router:  23%|██▎       | 42/180 [00:02<00:07, 18.42it/s][A
Analyzing router:  24%|██▍       | 44/180 [00:02<00:07, 18.67it/s][A
Analyzing router:  26%|██▌       | 46/180 [00:02<00:07, 18.48it/s][A
Analyzing router:  27%|██▋       | 48/180 [00:02<00:06, 18.86it/s][A
Analyzing router:  28%|██▊       | 50/180 [00:02<00:07, 18.39it/s][A
Analyzing router:  29%|██▉       | 53/180 [00:02<00:06, 18.85it/s][A
Analyzing router:  31%|███       | 55/180 [00:02<00:06, 18.75it/s][A
Analyzing router:  32%|███▏      | 57/180 [00:03<00:06, 18.58it/s][A
Analyzing router:  33%|███▎      | 60/180 [00:03<00:06, 19.18it/s][A
Analyzing router:  34%|███▍      | 62/180 [00:03<00:06, 18.91it/s][A
Analyzing router:  36%|███▌      | 64/180 [00:03<00:06, 19.04it/s][A
Analyzing router:  37%|███▋      | 66/180 [00:03<00:06, 18.69it/s][A
Analyzing router:  38%|███▊      | 68/180 [00:03<00:05, 19.03it/s][A
Analyzing router:  39%|███▉      | 70/180 [00:03<00:05, 18.76it/s][A
Analyzing router:  41%|████      | 73/180 [00:03<00:05, 18.93it/s][A
Analyzing router:  42%|████▏     | 75/180 [00:03<00:05, 18.57it/s][A
Analyzing router:  43%|████▎     | 77/180 [00:04<00:05, 18.91it/s][A
Analyzing router:  44%|████▍     | 79/180 [00:04<00:05, 18.26it/s][A
Analyzing router:  46%|████▌     | 82/180 [00:04<00:05, 18.79it/s][A
Analyzing router:  47%|████▋     | 84/180 [00:04<00:05, 18.62it/s][A
Analyzing router:  48%|████▊     | 86/180 [00:04<00:05, 18.53it/s][A
Analyzing router:  49%|████▉     | 88/180 [00:04<00:04, 18.46it/s][A
Analyzing router:  50%|█████     | 90/180 [00:04<00:04, 18.46it/s][A
Analyzing router:  51%|█████     | 92/180 [00:04<00:04, 18.61it/s][A
Analyzing router:  52%|█████▏    | 94/180 [00:05<00:04, 18.51it/s][A
Analyzing router:  53%|█████▎    | 96/180 [00:05<00:04, 18.40it/s][A
Analyzing router:  55%|█████▌    | 99/180 [00:05<00:04, 18.54it/s][A
Analyzing router:  56%|█████▌    | 101/180 [00:05<00:04, 18.46it/s][A
Analyzing router:  57%|█████▋    | 103/180 [00:05<00:04, 18.73it/s][A
Analyzing router:  59%|█████▉    | 106/180 [00:05<00:03, 19.14it/s][A
Analyzing router:  60%|██████    | 108/180 [00:05<00:03, 18.85it/s][A
Analyzing router:  61%|██████    | 110/180 [00:05<00:03, 18.77it/s][A
Analyzing router:  62%|██████▏   | 112/180 [00:05<00:03, 18.41it/s][A
Analyzing router:  63%|██████▎   | 114/180 [00:06<00:03, 18.58it/s][A
Analyzing router:  64%|██████▍   | 116/180 [00:06<00:03, 18.86it/s][A
Analyzing router:  66%|██████▌   | 118/180 [00:06<00:03, 19.00it/s][A
Analyzing router:  67%|██████▋   | 120/180 [00:06<00:03, 18.96it/s][A
Analyzing router:  68%|██████▊   | 122/180 [00:06<00:03, 19.25it/s][A
Analyzing router:  69%|██████▉   | 124/180 [00:06<00:02, 19.30it/s][A
Analyzing router:  70%|███████   | 126/180 [00:06<00:02, 19.14it/s][A
Analyzing router:  71%|███████   | 128/180 [00:06<00:02, 19.06it/s][A
Analyzing router:  72%|███████▏  | 130/180 [00:06<00:02, 19.17it/s][A
Analyzing router:  73%|███████▎  | 132/180 [00:07<00:02, 18.98it/s][A
Analyzing router:  74%|███████▍  | 134/180 [00:07<00:02, 19.23it/s][A
Analyzing router:  76%|███████▌  | 136/180 [00:07<00:02, 19.22it/s][A
Analyzing router:  77%|███████▋  | 138/180 [00:07<00:02, 18.62it/s][A
Analyzing router:  78%|███████▊  | 140/180 [00:07<00:02, 18.48it/s][A
Analyzing router:  79%|███████▉  | 142/180 [00:07<00:02, 18.62it/s][A
Analyzing router:  80%|████████  | 144/180 [00:07<00:01, 18.54it/s][A
Analyzing router:  81%|████████  | 146/180 [00:07<00:01, 18.41it/s][A
Analyzing router:  82%|████████▏ | 148/180 [00:07<00:01, 18.79it/s][A
Analyzing router:  83%|████████▎ | 150/180 [00:07<00:01, 18.79it/s][A
Analyzing router:  84%|████████▍ | 152/180 [00:08<00:01, 18.78it/s][A
Analyzing router:  86%|████████▌ | 155/180 [00:08<00:01, 19.03it/s][A
Analyzing router:  87%|████████▋ | 157/180 [00:08<00:01, 19.22it/s][A
Analyzing router:  88%|████████▊ | 159/180 [00:08<00:01, 19.03it/s][A
Analyzing router:  89%|████████▉ | 161/180 [00:08<00:00, 19.09it/s][A
Analyzing router:  91%|█████████ | 163/180 [00:08<00:00, 19.01it/s][A
Analyzing router:  92%|█████████▏| 165/180 [00:08<00:00, 18.78it/s][A
Analyzing router:  93%|█████████▎| 167/180 [00:08<00:00, 18.55it/s][A
Analyzing router:  94%|█████████▍| 169/180 [00:08<00:00, 18.75it/s][A
Analyzing router:  95%|█████████▌| 171/180 [00:09<00:00, 19.03it/s][A
Analyzing router:  96%|█████████▌| 173/180 [00:09<00:00, 18.63it/s][A
Analyzing router:  97%|█████████▋| 175/180 [00:09<00:00, 18.93it/s][A
Analyzing router:  98%|█████████▊| 177/180 [00:09<00:00, 18.65it/s][A
Analyzing router:  99%|█████████▉| 179/180 [00:09<00:00, 18.90it/s][AAnalyzing router: 100%|██████████| 180/180 [00:09<00:00, 18.80it/s]
🔍 Router Argmax Selection Distribution (Hard Routing):
Expert 1: 1440 samples (100.00%)

📊 Router Softmax Weights Distribution (Soft Routing):
Expert 0: average weight = 0.0894
Expert 1: average weight = 0.3457
Expert 2: average weight = 0.0815
Expert 3: average weight = 0.0805
Expert 4: average weight = 0.1616
Expert 5: average weight = 0.2413

Epoch 4/5:   0%|          | 0/180 [00:00<?, ?it/s][A                                                            
Epoch 4/5:   0%|          | 0/180 [00:00<?, ?it/s, loss=0.754][A
Epoch 4/5:   0%|          | 0/180 [00:00<?, ?it/s, loss=0.718][A
Epoch 4/5:   0%|          | 0/180 [00:01<?, ?it/s, loss=0.584][A
Epoch 4/5:   0%|          | 0/180 [00:01<?, ?it/s, loss=0.596][A
Epoch 4/5:   0%|          | 0/180 [00:02<?, ?it/s, loss=0.574][A
Epoch 4/5:   0%|          | 0/180 [00:02<?, ?it/s, loss=0.5]  [A
Epoch 4/5:   0%|          | 0/180 [00:03<?, ?it/s, loss=0.751][A
Epoch 4/5:   0%|          | 0/180 [00:03<?, ?it/s, loss=0.5]  [A
Epoch 4/5:   0%|          | 0/180 [00:04<?, ?it/s, loss=0.727][A
Epoch 4/5:   0%|          | 0/180 [00:04<?, ?it/s, loss=0.486][A
Epoch 4/5:   0%|          | 0/180 [00:05<?, ?it/s, loss=0.571][A
Epoch 4/5:   0%|          | 0/180 [00:05<?, ?it/s, loss=0.56] [A
Epoch 4/5:   0%|          | 0/180 [00:06<?, ?it/s, loss=0.642][A
Epoch 4/5:   0%|          | 0/180 [00:06<?, ?it/s, loss=0.51] [A
Epoch 4/5:   0%|          | 0/180 [00:06<?, ?it/s, loss=0.643][A
Epoch 4/5:   0%|          | 0/180 [00:07<?, ?it/s, loss=0.61] [A
Epoch 4/5:   0%|          | 0/180 [00:07<?, ?it/s, loss=0.517][A
Epoch 4/5:   0%|          | 0/180 [00:08<?, ?it/s, loss=0.737][A
Epoch 4/5:   0%|          | 0/180 [00:08<?, ?it/s, loss=0.565][A
Epoch 4/5:   0%|          | 0/180 [00:09<?, ?it/s, loss=0.587][A
Epoch 4/5:   0%|          | 0/180 [00:09<?, ?it/s, loss=0.481][A
Epoch 4/5:   0%|          | 0/180 [00:10<?, ?it/s, loss=0.428][A
Epoch 4/5:   0%|          | 0/180 [00:10<?, ?it/s, loss=0.765][A
Epoch 4/5:   0%|          | 0/180 [00:11<?, ?it/s, loss=0.451][A
Epoch 4/5:   0%|          | 0/180 [00:11<?, ?it/s, loss=0.489][A
Epoch 4/5:   0%|          | 0/180 [00:12<?, ?it/s, loss=0.662][A
Epoch 4/5:   0%|          | 0/180 [00:12<?, ?it/s, loss=0.674][A
Epoch 4/5:   0%|          | 0/180 [00:12<?, ?it/s, loss=0.563][A
Epoch 4/5:   0%|          | 0/180 [00:13<?, ?it/s, loss=0.534][A
Epoch 4/5:   0%|          | 0/180 [00:13<?, ?it/s, loss=0.628][A
Epoch 4/5:   0%|          | 0/180 [00:14<?, ?it/s, loss=0.496][A
Epoch 4/5:   0%|          | 0/180 [00:14<?, ?it/s, loss=0.684][A
Epoch 4/5:   0%|          | 0/180 [00:15<?, ?it/s, loss=0.437][A
Epoch 4/5:   0%|          | 0/180 [00:15<?, ?it/s, loss=0.57] [A
Epoch 4/5:   0%|          | 0/180 [00:16<?, ?it/s, loss=0.632][A
Epoch 4/5:   0%|          | 0/180 [00:16<?, ?it/s, loss=0.666][A
Epoch 4/5:   0%|          | 0/180 [00:17<?, ?it/s, loss=0.652][A
Epoch 4/5:   0%|          | 0/180 [00:17<?, ?it/s, loss=0.691][A
Epoch 4/5:   0%|          | 0/180 [00:18<?, ?it/s, loss=0.53] [A
Epoch 4/5:   0%|          | 0/180 [00:18<?, ?it/s, loss=0.542][A
Epoch 4/5:   0%|          | 0/180 [00:19<?, ?it/s, loss=0.514][A
Epoch 4/5:   0%|          | 0/180 [00:19<?, ?it/s, loss=0.511][A
Epoch 4/5:   0%|          | 0/180 [00:19<?, ?it/s, loss=0.33] [A
Epoch 4/5:   0%|          | 0/180 [00:20<?, ?it/s, loss=0.677][A
Epoch 4/5:   0%|          | 0/180 [00:20<?, ?it/s, loss=0.73] [A
Epoch 4/5:   0%|          | 0/180 [00:21<?, ?it/s, loss=0.793][A
Epoch 4/5:   0%|          | 0/180 [00:21<?, ?it/s, loss=0.506][A
Epoch 4/5:   0%|          | 0/180 [00:22<?, ?it/s, loss=0.675][A
Epoch 4/5:   0%|          | 0/180 [00:22<?, ?it/s, loss=0.631][A
Epoch 4/5:   0%|          | 0/180 [00:23<?, ?it/s, loss=0.605][A
Epoch 4/5:   0%|          | 0/180 [00:23<?, ?it/s, loss=0.614][A
Epoch 4/5:   0%|          | 0/180 [00:24<?, ?it/s, loss=0.707][A
Epoch 4/5:   0%|          | 0/180 [00:24<?, ?it/s, loss=0.569][A
Epoch 4/5:   0%|          | 0/180 [00:25<?, ?it/s, loss=0.524][A
Epoch 4/5:   0%|          | 0/180 [00:25<?, ?it/s, loss=0.618][A
Epoch 4/5:   0%|          | 0/180 [00:26<?, ?it/s, loss=0.571][A
Epoch 4/5:   0%|          | 0/180 [00:26<?, ?it/s, loss=0.467][A
Epoch 4/5:   0%|          | 0/180 [00:26<?, ?it/s, loss=0.743][A
Epoch 4/5:   0%|          | 0/180 [00:27<?, ?it/s, loss=0.762][A
Epoch 4/5:   0%|          | 0/180 [00:27<?, ?it/s, loss=0.7]  [A
Epoch 4/5:   0%|          | 0/180 [00:28<?, ?it/s, loss=0.654][A
Epoch 4/5:   0%|          | 0/180 [00:28<?, ?it/s, loss=0.756][A
Epoch 4/5:   0%|          | 0/180 [00:29<?, ?it/s, loss=0.611][A
Epoch 4/5:   0%|          | 0/180 [00:29<?, ?it/s, loss=0.664][A
Epoch 4/5:   0%|          | 0/180 [00:30<?, ?it/s, loss=0.614][A
Epoch 4/5:   0%|          | 0/180 [00:30<?, ?it/s, loss=0.617][A
Epoch 4/5:   0%|          | 0/180 [00:31<?, ?it/s, loss=0.54] [A
Epoch 4/5:   0%|          | 0/180 [00:31<?, ?it/s, loss=0.596][A
Epoch 4/5:   0%|          | 0/180 [00:32<?, ?it/s, loss=0.585][A
Epoch 4/5:   0%|          | 0/180 [00:32<?, ?it/s, loss=0.585][A
Epoch 4/5:   0%|          | 0/180 [00:33<?, ?it/s, loss=0.596][A
Epoch 4/5:   0%|          | 0/180 [00:33<?, ?it/s, loss=0.508][A
Epoch 4/5:   0%|          | 0/180 [00:33<?, ?it/s, loss=0.62] [A
Epoch 4/5:   0%|          | 0/180 [00:34<?, ?it/s, loss=0.511][A
Epoch 4/5:   0%|          | 0/180 [00:34<?, ?it/s, loss=0.713][A
Epoch 4/5:   0%|          | 0/180 [00:35<?, ?it/s, loss=0.67] [A
Epoch 4/5:   0%|          | 0/180 [00:35<?, ?it/s, loss=0.658][A
Epoch 4/5:   0%|          | 0/180 [00:36<?, ?it/s, loss=0.499][A
Epoch 4/5:   0%|          | 0/180 [00:36<?, ?it/s, loss=0.597][A
Epoch 4/5:   0%|          | 0/180 [00:37<?, ?it/s, loss=0.76] [A
Epoch 4/5:   0%|          | 0/180 [00:37<?, ?it/s, loss=0.709][A
Epoch 4/5:   0%|          | 0/180 [00:38<?, ?it/s, loss=0.683][A
Epoch 4/5:   0%|          | 0/180 [00:38<?, ?it/s, loss=0.589][A
Epoch 4/5:   0%|          | 0/180 [00:39<?, ?it/s, loss=0.707][A
Epoch 4/5:   0%|          | 0/180 [00:39<?, ?it/s, loss=0.695][A
Epoch 4/5:   0%|          | 0/180 [00:39<?, ?it/s, loss=0.67] [A
Epoch 4/5:   0%|          | 0/180 [00:40<?, ?it/s, loss=0.507][A
Epoch 4/5:   0%|          | 0/180 [00:40<?, ?it/s, loss=0.883][A
Epoch 4/5:   0%|          | 0/180 [00:41<?, ?it/s, loss=0.442][A
Epoch 4/5:   0%|          | 0/180 [00:41<?, ?it/s, loss=0.562][A
Epoch 4/5:   0%|          | 0/180 [00:42<?, ?it/s, loss=0.685][A
Epoch 4/5:   0%|          | 0/180 [00:42<?, ?it/s, loss=0.531][A
Epoch 4/5:   0%|          | 0/180 [00:43<?, ?it/s, loss=0.457][A
Epoch 4/5:   0%|          | 0/180 [00:43<?, ?it/s, loss=0.429][A
Epoch 4/5:   0%|          | 0/180 [00:44<?, ?it/s, loss=0.586][A
Epoch 4/5:   0%|          | 0/180 [00:44<?, ?it/s, loss=0.691][A
Epoch 4/5:   0%|          | 0/180 [00:45<?, ?it/s, loss=0.437][A
Epoch 4/5:   0%|          | 0/180 [00:45<?, ?it/s, loss=0.868][A
Epoch 4/5:   0%|          | 0/180 [00:46<?, ?it/s, loss=0.398][A
Epoch 4/5:   0%|          | 0/180 [00:46<?, ?it/s, loss=0.503][A
Epoch 4/5:   0%|          | 0/180 [00:46<?, ?it/s, loss=0.819][A
Epoch 4/5:   0%|          | 0/180 [00:47<?, ?it/s, loss=0.638][A
Epoch 4/5:   0%|          | 0/180 [00:47<?, ?it/s, loss=0.675][A
Epoch 4/5:   0%|          | 0/180 [00:48<?, ?it/s, loss=0.661][A
Epoch 4/5:   0%|          | 0/180 [00:48<?, ?it/s, loss=0.766][A
Epoch 4/5:   0%|          | 0/180 [00:49<?, ?it/s, loss=0.465][A
Epoch 4/5:   0%|          | 0/180 [00:49<?, ?it/s, loss=0.452][A
Epoch 4/5:   0%|          | 0/180 [00:50<?, ?it/s, loss=0.423][A
Epoch 4/5:   0%|          | 0/180 [00:50<?, ?it/s, loss=0.677][A
Epoch 4/5:   0%|          | 0/180 [00:51<?, ?it/s, loss=0.577][A
Epoch 4/5:   0%|          | 0/180 [00:51<?, ?it/s, loss=0.627][A
Epoch 4/5:   0%|          | 0/180 [00:52<?, ?it/s, loss=0.81] [A
Epoch 4/5:   0%|          | 0/180 [00:52<?, ?it/s, loss=0.728][A
Epoch 4/5:   0%|          | 0/180 [00:53<?, ?it/s, loss=0.439][A
Epoch 4/5:   0%|          | 0/180 [00:53<?, ?it/s, loss=0.382][A
Epoch 4/5:   0%|          | 0/180 [00:53<?, ?it/s, loss=0.542][A
Epoch 4/5:   0%|          | 0/180 [00:54<?, ?it/s, loss=0.678][A
Epoch 4/5:   0%|          | 0/180 [00:54<?, ?it/s, loss=0.767][A
Epoch 4/5:   0%|          | 0/180 [00:55<?, ?it/s, loss=0.571][A
Epoch 4/5:   0%|          | 0/180 [00:55<?, ?it/s, loss=0.62] [A
Epoch 4/5:   0%|          | 0/180 [00:56<?, ?it/s, loss=0.705][A
Epoch 4/5:   0%|          | 0/180 [00:56<?, ?it/s, loss=0.62] [A
Epoch 4/5:   0%|          | 0/180 [00:57<?, ?it/s, loss=0.605][A
Epoch 4/5:   0%|          | 0/180 [00:57<?, ?it/s, loss=0.533][A
Epoch 4/5:   0%|          | 0/180 [00:58<?, ?it/s, loss=0.555][A
Epoch 4/5:   0%|          | 0/180 [00:58<?, ?it/s, loss=0.47] [A
Epoch 4/5:   0%|          | 0/180 [00:59<?, ?it/s, loss=0.434][A
Epoch 4/5:   0%|          | 0/180 [00:59<?, ?it/s, loss=0.518][A
Epoch 4/5:   0%|          | 0/180 [01:00<?, ?it/s, loss=0.472][A
Epoch 4/5:   0%|          | 0/180 [01:00<?, ?it/s, loss=0.411][A
Epoch 4/5:   0%|          | 0/180 [01:01<?, ?it/s, loss=0.358][A
Epoch 4/5:   0%|          | 0/180 [01:01<?, ?it/s, loss=0.687][A
Epoch 4/5:   0%|          | 0/180 [01:02<?, ?it/s, loss=0.493][A
Epoch 4/5:   0%|          | 0/180 [01:02<?, ?it/s, loss=0.44] [A
Epoch 4/5:   0%|          | 0/180 [01:03<?, ?it/s, loss=0.453][A
Epoch 4/5:   0%|          | 0/180 [01:03<?, ?it/s, loss=0.998][A
Epoch 4/5:   0%|          | 0/180 [01:03<?, ?it/s, loss=0.624][A
Epoch 4/5:   0%|          | 0/180 [01:04<?, ?it/s, loss=0.648][A
Epoch 4/5:   0%|          | 0/180 [01:04<?, ?it/s, loss=0.544][A
Epoch 4/5:   0%|          | 0/180 [01:05<?, ?it/s, loss=0.533][A
Epoch 4/5:   0%|          | 0/180 [01:05<?, ?it/s, loss=0.801][A
Epoch 4/5:   0%|          | 0/180 [01:06<?, ?it/s, loss=0.43] [A
Epoch 4/5:   0%|          | 0/180 [01:06<?, ?it/s, loss=0.493][A
Epoch 4/5:   0%|          | 0/180 [01:07<?, ?it/s, loss=0.369][A
Epoch 4/5:   0%|          | 0/180 [01:07<?, ?it/s, loss=0.69] [A
Epoch 4/5:   0%|          | 0/180 [01:08<?, ?it/s, loss=0.519][A
Epoch 4/5:   0%|          | 0/180 [01:08<?, ?it/s, loss=0.606][A
Epoch 4/5:   0%|          | 0/180 [01:09<?, ?it/s, loss=0.501][A
Epoch 4/5:   0%|          | 0/180 [01:09<?, ?it/s, loss=0.48] [A
Epoch 4/5:   0%|          | 0/180 [01:10<?, ?it/s, loss=0.645][A
Epoch 4/5:   0%|          | 0/180 [01:10<?, ?it/s, loss=0.277][A
Epoch 4/5:   0%|          | 0/180 [01:11<?, ?it/s, loss=0.799][A
Epoch 4/5:   0%|          | 0/180 [01:11<?, ?it/s, loss=0.496][A
Epoch 4/5:   0%|          | 0/180 [01:12<?, ?it/s, loss=0.638][A
Epoch 4/5:   0%|          | 0/180 [01:12<?, ?it/s, loss=0.301][A
Epoch 4/5:   0%|          | 0/180 [01:13<?, ?it/s, loss=0.569][A
Epoch 4/5:   0%|          | 0/180 [01:13<?, ?it/s, loss=0.564][A
Epoch 4/5:   0%|          | 0/180 [01:14<?, ?it/s, loss=0.327][A
Epoch 4/5:   0%|          | 0/180 [01:14<?, ?it/s, loss=0.511][A
Epoch 4/5:   0%|          | 0/180 [01:14<?, ?it/s, loss=0.602][A
Epoch 4/5:   0%|          | 0/180 [01:15<?, ?it/s, loss=0.812][A
Epoch 4/5:   0%|          | 0/180 [01:15<?, ?it/s, loss=0.723][A
Epoch 4/5:   0%|          | 0/180 [01:16<?, ?it/s, loss=0.434][A
Epoch 4/5:   0%|          | 0/180 [01:16<?, ?it/s, loss=0.585][A
Epoch 4/5:   0%|          | 0/180 [01:17<?, ?it/s, loss=0.61] [A
Epoch 4/5:   0%|          | 0/180 [01:17<?, ?it/s, loss=0.379][A
Epoch 4/5:   0%|          | 0/180 [01:18<?, ?it/s, loss=0.721][A
Epoch 4/5:   0%|          | 0/180 [01:18<?, ?it/s, loss=0.595][A
Epoch 4/5:   0%|          | 0/180 [01:19<?, ?it/s, loss=0.448][A
Epoch 4/5:   0%|          | 0/180 [01:19<?, ?it/s, loss=0.687][A
Epoch 4/5:   0%|          | 0/180 [01:20<?, ?it/s, loss=0.628][A
Epoch 4/5:   0%|          | 0/180 [01:20<?, ?it/s, loss=0.34] [A
Epoch 4/5:   0%|          | 0/180 [01:21<?, ?it/s, loss=0.486][A
Epoch 4/5:   0%|          | 0/180 [01:21<?, ?it/s, loss=0.397][A
Epoch 4/5:   0%|          | 0/180 [01:22<?, ?it/s, loss=0.499][A
Epoch 4/5:   0%|          | 0/180 [01:22<?, ?it/s, loss=0.693][A
Epoch 4/5:   0%|          | 0/180 [01:23<?, ?it/s, loss=0.585][A
Epoch 4/5:   0%|          | 0/180 [01:23<?, ?it/s, loss=0.456][A
Epoch 4/5:   0%|          | 0/180 [01:24<?, ?it/s, loss=0.465][A
Epoch 4/5:   0%|          | 0/180 [01:24<?, ?it/s, loss=0.286][AEpoch 4/5 - Loss: 105.2056 - Train Acc: 0.6931 - Val Acc: 0.7667
Analyzing router:   0%|          | 0/180 [00:00<?, ?it/s]Analyzing router:   1%|          | 2/180 [00:00<00:09, 18.40it/s]Analyzing router:   2%|▏         | 4/180 [00:00<00:09, 18.35it/s]Analyzing router:   3%|▎         | 6/180 [00:00<00:09, 18.29it/s]Analyzing router:   4%|▍         | 8/180 [00:00<00:09, 18.41it/s]Analyzing router:   6%|▌         | 10/180 [00:00<00:09, 18.67it/s]Analyzing router:   7%|▋         | 12/180 [00:00<00:09, 18.10it/s]Analyzing router:   8%|▊         | 14/180 [00:00<00:08, 18.60it/s]Analyzing router:   9%|▉         | 16/180 [00:00<00:08, 18.46it/s]Analyzing router:  10%|█         | 18/180 [00:00<00:08, 18.32it/s]Analyzing router:  11%|█         | 20/180 [00:01<00:08, 18.61it/s]Analyzing router:  12%|█▏        | 22/180 [00:01<00:08, 18.94it/s]Analyzing router:  13%|█▎        | 24/180 [00:01<00:08, 19.07it/s]Analyzing router:  15%|█▌        | 27/180 [00:01<00:07, 19.30it/s]Analyzing router:  16%|█▌        | 29/180 [00:01<00:07, 19.13it/s]Analyzing router:  17%|█▋        | 31/180 [00:01<00:07, 19.12it/s]Analyzing router:  18%|█▊        | 33/180 [00:01<00:07, 18.83it/s]Analyzing router:  20%|██        | 36/180 [00:01<00:07, 19.18it/s]Analyzing router:  21%|██        | 38/180 [00:02<00:07, 19.28it/s]Analyzing router:  22%|██▏       | 40/180 [00:02<00:07, 18.79it/s]Analyzing router:  23%|██▎       | 42/180 [00:02<00:07, 18.71it/s]Analyzing router:  24%|██▍       | 44/180 [00:02<00:07, 19.02it/s]Analyzing router:  26%|██▌       | 46/180 [00:02<00:07, 18.76it/s]Analyzing router:  27%|██▋       | 48/180 [00:02<00:07, 18.59it/s]Analyzing router:  28%|██▊       | 50/180 [00:02<00:07, 18.28it/s]Analyzing router:  29%|██▉       | 52/180 [00:02<00:07, 18.18it/s]Analyzing router:  30%|███       | 54/180 [00:02<00:06, 18.36it/s]Analyzing router:  31%|███       | 56/180 [00:02<00:06, 18.55it/s]Analyzing router:  32%|███▏      | 58/180 [00:03<00:06, 18.06it/s]Analyzing router:  33%|███▎      | 60/180 [00:03<00:06, 18.38it/s]Analyzing router:  34%|███▍      | 62/180 [00:03<00:06, 18.44it/s]Analyzing router:  36%|███▌      | 64/180 [00:03<00:06, 18.11it/s]Analyzing router:  37%|███▋      | 67/180 [00:03<00:05, 19.18it/s]Analyzing router:  38%|███▊      | 69/180 [00:03<00:05, 18.69it/s]Analyzing router:  39%|███▉      | 71/180 [00:03<00:05, 18.68it/s]Analyzing router:  41%|████      | 73/180 [00:03<00:05, 18.45it/s]Analyzing router:  42%|████▏     | 75/180 [00:04<00:05, 18.08it/s]Analyzing router:  43%|████▎     | 77/180 [00:04<00:05, 18.33it/s]Analyzing router:  44%|████▍     | 79/180 [00:04<00:05, 18.69it/s]Analyzing router:  45%|████▌     | 81/180 [00:04<00:05, 18.41it/s]Analyzing router:  47%|████▋     | 84/180 [00:04<00:05, 18.91it/s]Analyzing router:  48%|████▊     | 87/180 [00:04<00:04, 19.10it/s]Analyzing router:  49%|████▉     | 89/180 [00:04<00:04, 19.23it/s]Analyzing router:  51%|█████     | 91/180 [00:04<00:04, 18.88it/s]Analyzing router:  52%|█████▏    | 93/180 [00:04<00:04, 19.00it/s]Analyzing router:  53%|█████▎    | 95/180 [00:05<00:04, 19.11it/s]Analyzing router:  54%|█████▍    | 97/180 [00:05<00:04, 19.30it/s]Analyzing router:  55%|█████▌    | 99/180 [00:05<00:04, 19.29it/s]Analyzing router:  56%|█████▌    | 101/180 [00:05<00:04, 19.48it/s]Analyzing router:  57%|█████▋    | 103/180 [00:05<00:04, 19.11it/s]Analyzing router:  58%|█████▊    | 105/180 [00:05<00:03, 18.91it/s]Analyzing router:  59%|█████▉    | 107/180 [00:05<00:03, 18.92it/s]Analyzing router:  61%|██████    | 109/180 [00:05<00:03, 18.86it/s]Analyzing router:  62%|██████▏   | 111/180 [00:05<00:03, 18.86it/s]Analyzing router:  63%|██████▎   | 113/180 [00:06<00:03, 18.30it/s]Analyzing router:  64%|██████▍   | 115/180 [00:06<00:03, 18.54it/s]Analyzing router:  65%|██████▌   | 117/180 [00:06<00:03, 18.51it/s]Analyzing router:  66%|██████▌   | 119/180 [00:06<00:03, 18.65it/s]Analyzing router:  67%|██████▋   | 121/180 [00:06<00:03, 18.88it/s]Analyzing router:  69%|██████▉   | 124/180 [00:06<00:02, 19.17it/s]Analyzing router:  70%|███████   | 126/180 [00:06<00:02, 19.07it/s]Analyzing router:  71%|███████   | 128/180 [00:06<00:02, 19.20it/s]Analyzing router:  72%|███████▏  | 130/180 [00:06<00:02, 18.79it/s]Analyzing router:  73%|███████▎  | 132/180 [00:07<00:02, 18.62it/s]Analyzing router:  74%|███████▍  | 134/180 [00:07<00:02, 18.83it/s]Analyzing router:  76%|███████▌  | 136/180 [00:07<00:02, 18.46it/s]Analyzing router:  77%|███████▋  | 138/180 [00:07<00:02, 18.43it/s]Analyzing router:  78%|███████▊  | 140/180 [00:07<00:02, 18.54it/s]Analyzing router:  79%|███████▉  | 142/180 [00:07<00:02, 18.72it/s]Analyzing router:  80%|████████  | 144/180 [00:07<00:01, 18.89it/s]Analyzing router:  82%|████████▏ | 147/180 [00:07<00:01, 19.22it/s]Analyzing router:  83%|████████▎ | 150/180 [00:07<00:01, 19.25it/s]Analyzing router:  84%|████████▍ | 152/180 [00:08<00:01, 19.34it/s]Analyzing router:  86%|████████▌ | 155/180 [00:08<00:01, 19.32it/s]Analyzing router:  87%|████████▋ | 157/180 [00:08<00:01, 19.48it/s]Analyzing router:  88%|████████▊ | 159/180 [00:08<00:01, 19.18it/s]Analyzing router:  89%|████████▉ | 161/180 [00:08<00:01, 18.72it/s]Analyzing router:  91%|█████████ | 163/180 [00:08<00:00, 18.35it/s]Analyzing router:  92%|█████████▏| 166/180 [00:08<00:00, 18.61it/s]Analyzing router:  94%|█████████▍| 169/180 [00:08<00:00, 18.94it/s]Analyzing router:  95%|█████████▌| 171/180 [00:09<00:00, 18.99it/s]Analyzing router:  96%|█████████▌| 173/180 [00:09<00:00, 19.10it/s]Analyzing router:  97%|█████████▋| 175/180 [00:09<00:00, 18.89it/s]Analyzing router:  98%|█████████▊| 177/180 [00:09<00:00, 18.81it/s]Analyzing router:  99%|█████████▉| 179/180 [00:09<00:00, 18.69it/s]Analyzing router: 100%|██████████| 180/180 [00:09<00:00, 18.80it/s]
🔍 Router Argmax Selection Distribution (Hard Routing):
Expert 1: 1440 samples (100.00%)

📊 Router Softmax Weights Distribution (Soft Routing):
Expert 0: average weight = 0.0267
Expert 1: average weight = 0.7242
Expert 2: average weight = 0.0241
Expert 3: average weight = 0.0262
Expert 4: average weight = 0.0566
Expert 5: average weight = 0.1423
✅ Saved best model at epoch 4 with val acc 0.7667
Epoch 5/5:   0%|          | 0/180 [00:00<?, ?it/s]
                                                              [AEpoch 5/5:   0%|          | 0/180 [00:00<?, ?it/s, loss=0.61]Epoch 5/5:   0%|          | 0/180 [00:00<?, ?it/s, loss=0.606]Epoch 5/5:   0%|          | 0/180 [00:01<?, ?it/s, loss=0.472]Epoch 5/5:   0%|          | 0/180 [00:01<?, ?it/s, loss=0.664]Epoch 5/5:   0%|          | 0/180 [00:02<?, ?it/s, loss=0.591]Epoch 5/5:   0%|          | 0/180 [00:02<?, ?it/s, loss=0.61] Epoch 5/5:   0%|          | 0/180 [00:03<?, ?it/s, loss=0.401]Epoch 5/5:   0%|          | 0/180 [00:03<?, ?it/s, loss=0.569]Epoch 5/5:   0%|          | 0/180 [00:04<?, ?it/s, loss=0.483]Epoch 5/5:   0%|          | 0/180 [00:04<?, ?it/s, loss=0.564]Epoch 5/5:   0%|          | 0/180 [00:05<?, ?it/s, loss=0.533]Epoch 5/5:   0%|          | 0/180 [00:05<?, ?it/s, loss=0.414]Epoch 5/5:   0%|          | 0/180 [00:06<?, ?it/s, loss=0.516]Epoch 5/5:   0%|          | 0/180 [00:06<?, ?it/s, loss=0.358]Epoch 5/5:   0%|          | 0/180 [00:07<?, ?it/s, loss=0.591]Epoch 5/5:   0%|          | 0/180 [00:07<?, ?it/s, loss=0.513]Epoch 5/5:   0%|          | 0/180 [00:08<?, ?it/s, loss=0.795]Epoch 5/5:   0%|          | 0/180 [00:08<?, ?it/s, loss=0.482]Epoch 5/5:   0%|          | 0/180 [00:09<?, ?it/s, loss=0.379]Epoch 5/5:   0%|          | 0/180 [00:09<?, ?it/s, loss=0.549]Epoch 5/5:   0%|          | 0/180 [00:09<?, ?it/s, loss=0.366]Epoch 5/5:   0%|          | 0/180 [00:10<?, ?it/s, loss=0.39] Epoch 5/5:   0%|          | 0/180 [00:10<?, ?it/s, loss=0.536]Epoch 5/5:   0%|          | 0/180 [00:11<?, ?it/s, loss=0.469]Epoch 5/5:   0%|          | 0/180 [00:11<?, ?it/s, loss=0.498]Epoch 5/5:   0%|          | 0/180 [00:12<?, ?it/s, loss=0.525]Epoch 5/5:   0%|          | 0/180 [00:12<?, ?it/s, loss=0.515]Epoch 5/5:   0%|          | 0/180 [00:13<?, ?it/s, loss=0.552]Epoch 5/5:   0%|          | 0/180 [00:13<?, ?it/s, loss=0.274]Epoch 5/5:   0%|          | 0/180 [00:14<?, ?it/s, loss=0.508]Epoch 5/5:   0%|          | 0/180 [00:14<?, ?it/s, loss=0.723]Epoch 5/5:   0%|          | 0/180 [00:15<?, ?it/s, loss=0.548]Epoch 5/5:   0%|          | 0/180 [00:15<?, ?it/s, loss=0.406]Epoch 5/5:   0%|          | 0/180 [00:16<?, ?it/s, loss=0.6]  Epoch 5/5:   0%|          | 0/180 [00:16<?, ?it/s, loss=0.703]Epoch 5/5:   0%|          | 0/180 [00:17<?, ?it/s, loss=0.388]Epoch 5/5:   0%|          | 0/180 [00:17<?, ?it/s, loss=0.429]Epoch 5/5:   0%|          | 0/180 [00:18<?, ?it/s, loss=0.472]Epoch 5/5:   0%|          | 0/180 [00:18<?, ?it/s, loss=0.896]Epoch 5/5:   0%|          | 0/180 [00:18<?, ?it/s, loss=0.8]  Epoch 5/5:   0%|          | 0/180 [00:19<?, ?it/s, loss=0.607]Epoch 5/5:   0%|          | 0/180 [00:19<?, ?it/s, loss=0.406]Epoch 5/5:   0%|          | 0/180 [00:20<?, ?it/s, loss=0.997]Epoch 5/5:   0%|          | 0/180 [00:20<?, ?it/s, loss=0.617]Epoch 5/5:   0%|          | 0/180 [00:21<?, ?it/s, loss=0.544]Epoch 5/5:   0%|          | 0/180 [00:21<?, ?it/s, loss=0.595]Epoch 5/5:   0%|          | 0/180 [00:22<?, ?it/s, loss=0.429]Epoch 5/5:   0%|          | 0/180 [00:22<?, ?it/s, loss=0.399]Epoch 5/5:   0%|          | 0/180 [00:23<?, ?it/s, loss=0.433]Epoch 5/5:   0%|          | 0/180 [00:23<?, ?it/s, loss=0.445]Epoch 5/5:   0%|          | 0/180 [00:24<?, ?it/s, loss=0.396]Epoch 5/5:   0%|          | 0/180 [00:24<?, ?it/s, loss=0.381]Epoch 5/5:   0%|          | 0/180 [00:25<?, ?it/s, loss=0.693]Epoch 5/5:   0%|          | 0/180 [00:25<?, ?it/s, loss=0.221]Epoch 5/5:   0%|          | 0/180 [00:26<?, ?it/s, loss=0.538]Epoch 5/5:   0%|          | 0/180 [00:26<?, ?it/s, loss=0.799]Epoch 5/5:   0%|          | 0/180 [00:27<?, ?it/s, loss=0.526]Epoch 5/5:   0%|          | 0/180 [00:27<?, ?it/s, loss=0.594]Epoch 5/5:   0%|          | 0/180 [00:28<?, ?it/s, loss=0.618]Epoch 5/5:   0%|          | 0/180 [00:28<?, ?it/s, loss=0.594]Epoch 5/5:   0%|          | 0/180 [00:28<?, ?it/s, loss=0.317]Epoch 5/5:   0%|          | 0/180 [00:29<?, ?it/s, loss=0.715]Epoch 5/5:   0%|          | 0/180 [00:29<?, ?it/s, loss=1.1]  Epoch 5/5:   0%|          | 0/180 [00:30<?, ?it/s, loss=0.619]Epoch 5/5:   0%|          | 0/180 [00:30<?, ?it/s, loss=0.319]Epoch 5/5:   0%|          | 0/180 [00:31<?, ?it/s, loss=0.526]Epoch 5/5:   0%|          | 0/180 [00:31<?, ?it/s, loss=0.432]Epoch 5/5:   0%|          | 0/180 [00:32<?, ?it/s, loss=0.441]Epoch 5/5:   0%|          | 0/180 [00:32<?, ?it/s, loss=0.757]Epoch 5/5:   0%|          | 0/180 [00:33<?, ?it/s, loss=0.45] Epoch 5/5:   0%|          | 0/180 [00:33<?, ?it/s, loss=0.576]Epoch 5/5:   0%|          | 0/180 [00:34<?, ?it/s, loss=0.395]Epoch 5/5:   0%|          | 0/180 [00:34<?, ?it/s, loss=0.567]Epoch 5/5:   0%|          | 0/180 [00:35<?, ?it/s, loss=0.455]Epoch 5/5:   0%|          | 0/180 [00:35<?, ?it/s, loss=0.44] Epoch 5/5:   0%|          | 0/180 [00:36<?, ?it/s, loss=0.734]Epoch 5/5:   0%|          | 0/180 [00:36<?, ?it/s, loss=0.452]Epoch 5/5:   0%|          | 0/180 [00:37<?, ?it/s, loss=0.818]Epoch 5/5:   0%|          | 0/180 [00:37<?, ?it/s, loss=0.363]Epoch 5/5:   0%|          | 0/180 [00:38<?, ?it/s, loss=0.438]Epoch 5/5:   0%|          | 0/180 [00:38<?, ?it/s, loss=0.39] Epoch 5/5:   0%|          | 0/180 [00:38<?, ?it/s, loss=0.383]Epoch 5/5:   0%|          | 0/180 [00:39<?, ?it/s, loss=0.298]Epoch 5/5:   0%|          | 0/180 [00:39<?, ?it/s, loss=0.299]Epoch 5/5:   0%|          | 0/180 [00:40<?, ?it/s, loss=0.743]Epoch 5/5:   0%|          | 0/180 [00:40<?, ?it/s, loss=0.517]Epoch 5/5:   0%|          | 0/180 [00:41<?, ?it/s, loss=0.348]Epoch 5/5:   0%|          | 0/180 [00:41<?, ?it/s, loss=0.501]Epoch 5/5:   0%|          | 0/180 [00:42<?, ?it/s, loss=0.283]Epoch 5/5:   0%|          | 0/180 [00:42<?, ?it/s, loss=0.472]Epoch 5/5:   0%|          | 0/180 [00:43<?, ?it/s, loss=0.564]Epoch 5/5:   0%|          | 0/180 [00:43<?, ?it/s, loss=0.542]Epoch 5/5:   0%|          | 0/180 [00:44<?, ?it/s, loss=0.7]  Epoch 5/5:   0%|          | 0/180 [00:44<?, ?it/s, loss=0.319]Epoch 5/5:   0%|          | 0/180 [00:45<?, ?it/s, loss=0.386]Epoch 5/5:   0%|          | 0/180 [00:45<?, ?it/s, loss=0.705]Epoch 5/5:   0%|          | 0/180 [00:46<?, ?it/s, loss=0.663]Epoch 5/5:   0%|          | 0/180 [00:46<?, ?it/s, loss=0.567]Epoch 5/5:   0%|          | 0/180 [00:47<?, ?it/s, loss=0.552]Epoch 5/5:   0%|          | 0/180 [00:47<?, ?it/s, loss=0.593]Epoch 5/5:   0%|          | 0/180 [00:48<?, ?it/s, loss=0.256]Epoch 5/5:   0%|          | 0/180 [00:48<?, ?it/s, loss=0.733]Epoch 5/5:   0%|          | 0/180 [00:49<?, ?it/s, loss=0.523]Epoch 5/5:   0%|          | 0/180 [00:49<?, ?it/s, loss=0.368]Epoch 5/5:   0%|          | 0/180 [00:49<?, ?it/s, loss=0.293]Epoch 5/5:   0%|          | 0/180 [00:50<?, ?it/s, loss=0.318]Epoch 5/5:   0%|          | 0/180 [00:50<?, ?it/s, loss=0.377]Epoch 5/5:   0%|          | 0/180 [00:51<?, ?it/s, loss=0.765]Epoch 5/5:   0%|          | 0/180 [00:51<?, ?it/s, loss=0.501]Epoch 5/5:   0%|          | 0/180 [00:52<?, ?it/s, loss=0.525]Epoch 5/5:   0%|          | 0/180 [00:52<?, ?it/s, loss=0.754]Epoch 5/5:   0%|          | 0/180 [00:53<?, ?it/s, loss=0.636]Epoch 5/5:   0%|          | 0/180 [00:53<?, ?it/s, loss=0.551]Epoch 5/5:   0%|          | 0/180 [00:54<?, ?it/s, loss=0.912]Epoch 5/5:   0%|          | 0/180 [00:54<?, ?it/s, loss=0.488]Epoch 5/5:   0%|          | 0/180 [00:55<?, ?it/s, loss=0.22] Epoch 5/5:   0%|          | 0/180 [00:55<?, ?it/s, loss=0.494]Epoch 5/5:   0%|          | 0/180 [00:56<?, ?it/s, loss=0.703]Epoch 5/5:   0%|          | 0/180 [00:56<?, ?it/s, loss=0.408]Epoch 5/5:   0%|          | 0/180 [00:57<?, ?it/s, loss=0.492]Epoch 5/5:   0%|          | 0/180 [00:57<?, ?it/s, loss=0.485]Epoch 5/5:   0%|          | 0/180 [00:58<?, ?it/s, loss=0.453]Epoch 5/5:   0%|          | 0/180 [00:58<?, ?it/s, loss=0.408]Epoch 5/5:   0%|          | 0/180 [00:59<?, ?it/s, loss=0.508]Epoch 5/5:   0%|          | 0/180 [00:59<?, ?it/s, loss=0.429]Epoch 5/5:   0%|          | 0/180 [01:00<?, ?it/s, loss=0.347]Epoch 5/5:   0%|          | 0/180 [01:00<?, ?it/s, loss=0.283]Epoch 5/5:   0%|          | 0/180 [01:00<?, ?it/s, loss=0.516]Epoch 5/5:   0%|          | 0/180 [01:01<?, ?it/s, loss=0.503]Epoch 5/5:   0%|          | 0/180 [01:01<?, ?it/s, loss=0.422]Epoch 5/5:   0%|          | 0/180 [01:02<?, ?it/s, loss=0.731]Epoch 5/5:   0%|          | 0/180 [01:02<?, ?it/s, loss=0.611]Epoch 5/5:   0%|          | 0/180 [01:03<?, ?it/s, loss=0.406]Epoch 5/5:   0%|          | 0/180 [01:03<?, ?it/s, loss=0.32] Epoch 5/5:   0%|          | 0/180 [01:04<?, ?it/s, loss=0.522]Epoch 5/5:   0%|          | 0/180 [01:04<?, ?it/s, loss=0.515]Epoch 5/5:   0%|          | 0/180 [01:05<?, ?it/s, loss=0.42] Epoch 5/5:   0%|          | 0/180 [01:05<?, ?it/s, loss=0.381]Epoch 5/5:   0%|          | 0/180 [01:06<?, ?it/s, loss=0.447]Epoch 5/5:   0%|          | 0/180 [01:06<?, ?it/s, loss=0.392]Epoch 5/5:   0%|          | 0/180 [01:07<?, ?it/s, loss=0.311]Epoch 5/5:   0%|          | 0/180 [01:07<?, ?it/s, loss=0.703]Epoch 5/5:   0%|          | 0/180 [01:08<?, ?it/s, loss=0.531]Epoch 5/5:   0%|          | 0/180 [01:08<?, ?it/s, loss=0.638]Epoch 5/5:   0%|          | 0/180 [01:09<?, ?it/s, loss=0.478]Epoch 5/5:   0%|          | 0/180 [01:09<?, ?it/s, loss=0.505]Epoch 5/5:   0%|          | 0/180 [01:10<?, ?it/s, loss=0.448]Epoch 5/5:   0%|          | 0/180 [01:10<?, ?it/s, loss=0.305]Epoch 5/5:   0%|          | 0/180 [01:11<?, ?it/s, loss=1]    Epoch 5/5:   0%|          | 0/180 [01:11<?, ?it/s, loss=0.494]Epoch 5/5:   0%|          | 0/180 [01:11<?, ?it/s, loss=0.44] Epoch 5/5:   0%|          | 0/180 [01:12<?, ?it/s, loss=0.207]Epoch 5/5:   0%|          | 0/180 [01:12<?, ?it/s, loss=0.437]Epoch 5/5:   0%|          | 0/180 [01:13<?, ?it/s, loss=0.622]Epoch 5/5:   0%|          | 0/180 [01:13<?, ?it/s, loss=0.809]Epoch 5/5:   0%|          | 0/180 [01:14<?, ?it/s, loss=0.426]Epoch 5/5:   0%|          | 0/180 [01:14<?, ?it/s, loss=0.358]Epoch 5/5:   0%|          | 0/180 [01:15<?, ?it/s, loss=0.581]Epoch 5/5:   0%|          | 0/180 [01:15<?, ?it/s, loss=0.651]Epoch 5/5:   0%|          | 0/180 [01:16<?, ?it/s, loss=0.819]Epoch 5/5:   0%|          | 0/180 [01:16<?, ?it/s, loss=0.654]Epoch 5/5:   0%|          | 0/180 [01:17<?, ?it/s, loss=0.505]Epoch 5/5:   0%|          | 0/180 [01:17<?, ?it/s, loss=0.814]Epoch 5/5:   0%|          | 0/180 [01:18<?, ?it/s, loss=0.336]Epoch 5/5:   0%|          | 0/180 [01:18<?, ?it/s, loss=0.514]Epoch 5/5:   0%|          | 0/180 [01:19<?, ?it/s, loss=0.215]Epoch 5/5:   0%|          | 0/180 [01:19<?, ?it/s, loss=0.36] Epoch 5/5:   0%|          | 0/180 [01:20<?, ?it/s, loss=0.329]Epoch 5/5:   0%|          | 0/180 [01:20<?, ?it/s, loss=0.522]Epoch 5/5:   0%|          | 0/180 [01:21<?, ?it/s, loss=0.305]Epoch 5/5:   0%|          | 0/180 [01:21<?, ?it/s, loss=0.496]Epoch 5/5:   0%|          | 0/180 [01:22<?, ?it/s, loss=0.341]Epoch 5/5:   0%|          | 0/180 [01:22<?, ?it/s, loss=0.419]Epoch 5/5:   0%|          | 0/180 [01:22<?, ?it/s, loss=0.356]Epoch 5/5:   0%|          | 0/180 [01:23<?, ?it/s, loss=0.555]Epoch 5/5:   0%|          | 0/180 [01:23<?, ?it/s, loss=0.333]Epoch 5/5:   0%|          | 0/180 [01:24<?, ?it/s, loss=0.343]Epoch 5/5:   0%|          | 0/180 [01:24<?, ?it/s, loss=0.217]Epoch 5/5:   0%|          | 0/180 [01:25<?, ?it/s, loss=0.145]Epoch 5/5:   0%|          | 0/180 [01:25<?, ?it/s, loss=0.813]Epoch 5/5 - Loss: 91.6298 - Train Acc: 0.7514 - Val Acc: 0.8139

Analyzing router:   0%|          | 0/180 [00:00<?, ?it/s][A
Analyzing router:   1%|          | 2/180 [00:00<00:10, 17.54it/s][A
Analyzing router:   2%|▏         | 4/180 [00:00<00:09, 18.53it/s][A
Analyzing router:   3%|▎         | 6/180 [00:00<00:09, 18.63it/s][A
Analyzing router:   4%|▍         | 8/180 [00:00<00:09, 18.50it/s][A
Analyzing router:   6%|▌         | 10/180 [00:00<00:09, 18.59it/s][A
Analyzing router:   7%|▋         | 12/180 [00:00<00:09, 18.55it/s][A
Analyzing router:   8%|▊         | 14/180 [00:00<00:09, 18.33it/s][A
Analyzing router:   9%|▉         | 16/180 [00:00<00:08, 18.72it/s][A
Analyzing router:  10%|█         | 18/180 [00:00<00:08, 18.65it/s][A
Analyzing router:  11%|█         | 20/180 [00:01<00:08, 18.43it/s][A
Analyzing router:  12%|█▏        | 22/180 [00:01<00:08, 18.38it/s][A
Analyzing router:  13%|█▎        | 24/180 [00:01<00:08, 18.19it/s][A
Analyzing router:  14%|█▍        | 26/180 [00:01<00:08, 18.45it/s][A
Analyzing router:  16%|█▌        | 28/180 [00:01<00:08, 18.54it/s][A
Analyzing router:  17%|█▋        | 30/180 [00:01<00:08, 18.53it/s][A
Analyzing router:  18%|█▊        | 32/180 [00:01<00:07, 18.67it/s][A
Analyzing router:  19%|█▉        | 34/180 [00:01<00:07, 19.02it/s][A
Analyzing router:  20%|██        | 36/180 [00:01<00:07, 18.96it/s][A
Analyzing router:  21%|██        | 38/180 [00:02<00:07, 19.23it/s][A
Analyzing router:  22%|██▏       | 40/180 [00:02<00:07, 19.20it/s][A
Analyzing router:  23%|██▎       | 42/180 [00:02<00:07, 18.76it/s][A
Analyzing router:  24%|██▍       | 44/180 [00:02<00:07, 18.56it/s][A
Analyzing router:  26%|██▌       | 46/180 [00:02<00:07, 18.88it/s][A
Analyzing router:  27%|██▋       | 48/180 [00:02<00:06, 19.12it/s][A
Analyzing router:  28%|██▊       | 51/180 [00:02<00:06, 19.38it/s][A
Analyzing router:  29%|██▉       | 53/180 [00:02<00:06, 18.89it/s][A
Analyzing router:  31%|███       | 55/180 [00:02<00:06, 18.82it/s][A
Analyzing router:  32%|███▏      | 57/180 [00:03<00:06, 18.89it/s][A
Analyzing router:  33%|███▎      | 59/180 [00:03<00:06, 19.02it/s][A
Analyzing router:  34%|███▍      | 61/180 [00:03<00:06, 18.86it/s][A
Analyzing router:  35%|███▌      | 63/180 [00:03<00:06, 18.75it/s][A
Analyzing router:  36%|███▌      | 65/180 [00:03<00:06, 18.78it/s][A
Analyzing router:  37%|███▋      | 67/180 [00:03<00:06, 18.74it/s][A
Analyzing router:  38%|███▊      | 69/180 [00:03<00:06, 18.30it/s][A
Analyzing router:  39%|███▉      | 71/180 [00:03<00:05, 18.46it/s][A
Analyzing router:  41%|████      | 73/180 [00:03<00:05, 18.81it/s][A
Analyzing router:  42%|████▏     | 75/180 [00:04<00:05, 18.85it/s][A
Analyzing router:  43%|████▎     | 77/180 [00:04<00:05, 19.13it/s][A
Analyzing router:  44%|████▍     | 79/180 [00:04<00:05, 18.97it/s][A
Analyzing router:  45%|████▌     | 81/180 [00:04<00:05, 18.96it/s][A
Analyzing router:  46%|████▌     | 83/180 [00:04<00:05, 18.99it/s][A
Analyzing router:  47%|████▋     | 85/180 [00:04<00:05, 18.90it/s][A
Analyzing router:  49%|████▉     | 88/180 [00:04<00:04, 19.13it/s][A
Analyzing router:  50%|█████     | 90/180 [00:04<00:04, 18.76it/s][A
Analyzing router:  51%|█████     | 92/180 [00:04<00:04, 18.78it/s][A
Analyzing router:  52%|█████▏    | 94/180 [00:05<00:04, 18.99it/s][A
Analyzing router:  54%|█████▍    | 97/180 [00:05<00:04, 19.32it/s][A
Analyzing router:  55%|█████▌    | 99/180 [00:05<00:04, 19.26it/s][A
Analyzing router:  56%|█████▌    | 101/180 [00:05<00:04, 19.09it/s][A
Analyzing router:  57%|█████▋    | 103/180 [00:05<00:04, 18.88it/s][A
Analyzing router:  58%|█████▊    | 105/180 [00:05<00:03, 18.89it/s][A
Analyzing router:  59%|█████▉    | 107/180 [00:05<00:03, 18.97it/s][A
Analyzing router:  61%|██████    | 109/180 [00:05<00:03, 18.53it/s][A
Analyzing router:  62%|██████▏   | 111/180 [00:05<00:03, 18.75it/s][A
Analyzing router:  63%|██████▎   | 113/180 [00:06<00:03, 18.33it/s][A
Analyzing router:  64%|██████▍   | 115/180 [00:06<00:03, 18.60it/s][A
Analyzing router:  65%|██████▌   | 117/180 [00:06<00:03, 18.47it/s][A
Analyzing router:  66%|██████▌   | 119/180 [00:06<00:03, 18.62it/s][A
Analyzing router:  67%|██████▋   | 121/180 [00:06<00:03, 18.67it/s][A
Analyzing router:  68%|██████▊   | 123/180 [00:06<00:03, 18.40it/s][A
Analyzing router:  69%|██████▉   | 125/180 [00:06<00:02, 18.41it/s][A
Analyzing router:  71%|███████   | 127/180 [00:06<00:02, 18.50it/s][A
Analyzing router:  72%|███████▏  | 129/180 [00:06<00:02, 18.49it/s][A
Analyzing router:  73%|███████▎  | 131/180 [00:06<00:02, 18.76it/s][A
Analyzing router:  74%|███████▍  | 134/180 [00:07<00:02, 18.92it/s][A
Analyzing router:  76%|███████▌  | 136/180 [00:07<00:02, 19.03it/s][A
Analyzing router:  77%|███████▋  | 139/180 [00:07<00:02, 19.35it/s][A
Analyzing router:  78%|███████▊  | 141/180 [00:07<00:02, 19.20it/s][A
Analyzing router:  79%|███████▉  | 143/180 [00:07<00:01, 18.74it/s][A
Analyzing router:  81%|████████  | 145/180 [00:07<00:01, 18.82it/s][A
Analyzing router:  82%|████████▏ | 147/180 [00:07<00:01, 18.80it/s][A
Analyzing router:  83%|████████▎ | 149/180 [00:07<00:01, 18.77it/s][A
Analyzing router:  84%|████████▍ | 151/180 [00:08<00:01, 19.01it/s][A
Analyzing router:  85%|████████▌ | 153/180 [00:08<00:01, 18.44it/s][A
Analyzing router:  86%|████████▌ | 155/180 [00:08<00:01, 18.66it/s][A
Analyzing router:  87%|████████▋ | 157/180 [00:08<00:01, 18.93it/s][A
Analyzing router:  88%|████████▊ | 159/180 [00:08<00:01, 18.73it/s][A
Analyzing router:  89%|████████▉ | 161/180 [00:08<00:01, 18.90it/s][A
Analyzing router:  91%|█████████ | 163/180 [00:08<00:00, 18.76it/s][A
Analyzing router:  92%|█████████▏| 165/180 [00:08<00:00, 18.43it/s][A
Analyzing router:  93%|█████████▎| 167/180 [00:08<00:00, 18.46it/s][A
Analyzing router:  94%|█████████▍| 169/180 [00:09<00:00, 18.69it/s][A
Analyzing router:  95%|█████████▌| 171/180 [00:09<00:00, 18.92it/s][A
Analyzing router:  96%|█████████▌| 173/180 [00:09<00:00, 18.79it/s][A
Analyzing router:  97%|█████████▋| 175/180 [00:09<00:00, 18.54it/s][A
Analyzing router:  98%|█████████▊| 177/180 [00:09<00:00, 18.38it/s][A
Analyzing router:  99%|█████████▉| 179/180 [00:09<00:00, 18.37it/s][AAnalyzing router: 100%|██████████| 180/180 [00:09<00:00, 18.75it/s]
                                                              🔍 Router Argmax Selection Distribution (Hard Routing):
Expert 1: 1440 samples (100.00%)

📊 Router Softmax Weights Distribution (Soft Routing):
Expert 0: average weight = 0.0134
Expert 1: average weight = 0.8380
Expert 2: average weight = 0.0119
Expert 3: average weight = 0.0136
Expert 4: average weight = 0.0291
Expert 5: average weight = 0.0939
✅ Saved best model at epoch 5 with val acc 0.8139

Best Val Acc = 0.8139 at Epoch 5
